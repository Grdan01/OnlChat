<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureChat | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 50%, #0c0c0c 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }
        
        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        .bg-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }
        
        #app {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }
        
        .container {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 8px;
            border: 1px solid #333;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å —Å–µ—Ä—å–µ–∑–Ω—ã–º —Ñ–æ–Ω–æ–º */
        #welcome-screen {
            background: 
                radial-gradient(circle at 20% 80%, rgba(40, 40, 40, 0.8) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(60, 60, 60, 0.6) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            text-align: center;
            padding: 60px 40px;
            position: relative;
            overflow: hidden;
            border: 1px solid #333;
        }
        
        #welcome-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 50%, rgba(255,255,255,0.03) 50%),
                linear-gradient(transparent 50%, rgba(255,255,255,0.03) 50%);
            background-size: 50px 50px;
            opacity: 0.1;
            z-index: 0;
        }
        
        #welcome-screen::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(100, 100, 100, 0.1) 0%, transparent 70%);
            animation: pulse 15s ease-in-out infinite;
            z-index: 0;
        }
        
        #welcome-screen > * {
            position: relative;
            z-index: 1;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.1; }
            50% { transform: scale(1.1); opacity: 0.2; }
        }
        
        .welcome-title {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 2px;
            color: #ffffff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .welcome-subtitle {
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: #b0b0b0;
            font-weight: 300;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .security-badge {
            display: inline-block;
            background: rgba(0, 100, 0, 0.2);
            border: 1px solid #2a7a2a;
            color: #4CAF50;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-top: 20px;
        }
        
        h1, h2, h3 {
            margin-bottom: 20px;
            color: #ffffff;
            font-weight: 400;
        }
        
        h1 {
            border-bottom: 1px solid #333;
            padding-bottom: 15px;
        }
        
        input, textarea, button, select {
            padding: 14px 16px;
            margin: 10px 0;
            border: 1px solid #444;
            border-radius: 6px;
            width: 100%;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(40, 40, 40, 0.8);
            color: #e0e0e0;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #4a76a8;
            box-shadow: 0 0 0 2px rgba(74, 118, 168, 0.2);
        }
        
        input::placeholder, textarea::placeholder {
            color: #888;
        }
        
        button {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            border: 1px solid #3a506b;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-size: 0.9rem;
        }
        
        button:hover {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border-color: #4a76a8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
            border-color: #a2352a;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            border-color: #219653;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #d35400 0%, #e67e22 100%);
            border-color: #b34700;
        }
        
        .btn-admin {
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
            border-color: #7d3c98;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .hidden {
            display: none;
        }
        
        .message {
            padding: 16px;
            margin: 12px 0;
            border-radius: 8px;
            background: rgba(50, 50, 50, 0.6);
            border-left: 4px solid #444;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .message:hover {
            background: rgba(60, 60, 60, 0.8);
            transform: translateX(5px);
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: #aaa;
        }
        
        .message-content {
            word-wrap: break-word;
            line-height: 1.5;
        }
        
        .my-message {
            background: rgba(30, 50, 70, 0.6);
            border-left: 4px solid #4a76a8;
        }
        
        .admin-message {
            background: rgba(70, 30, 70, 0.6);
            border-left: 4px solid #8e44ad;
        }
        
        .advertisement-message {
            background: rgba(70, 30, 30, 0.6);
            border-left: 4px solid #c0392b;
        }
        
        .private-message {
            background: rgba(30, 60, 50, 0.6);
            border-left: 4px solid #27ae60;
        }
        
        .chat-container {
            height: 450px;
            overflow-y: auto;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background: rgba(20, 20, 20, 0.6);
        }
        
        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
        .chat-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-container::-webkit-scrollbar-track {
            background: rgba(40, 40, 40, 0.5);
            border-radius: 4px;
        }
        
        .chat-container::-webkit-scrollbar-thumb {
            background: #4a76a8;
            border-radius: 4px;
        }
        
        .user-list {
            list-style-type: none;
            margin-top: 10px;
        }
        
        .user-list li {
            padding: 12px 16px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .user-list li:hover {
            background: rgba(50, 50, 50, 0.6);
        }
        
        .user-list li:last-child {
            border-bottom: none;
        }
        
        .admin-badge {
            background: #8e44ad;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .banned-badge {
            background: #c0392b;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .online-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #2ecc71;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .offline-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #95a5a6;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        
        .nav h2 {
            margin-bottom: 0;
            color: #ffffff;
            font-weight: 300;
        }
        
        .nav button {
            width: auto;
            padding: 10px 20px;
        }
        
        .error {
            color: #e74c3c;
            margin-top: 8px;
            font-size: 0.9em;
            padding: 12px;
            background: rgba(231, 76, 60, 0.1);
            border-radius: 6px;
            border-left: 4px solid #e74c3c;
        }
        
        .success {
            color: #2ecc71;
            margin-top: 8px;
            font-size: 0.9em;
            padding: 12px;
            background: rgba(46, 204, 113, 0.1);
            border-radius: 6px;
            border-left: 4px solid #2ecc71;
        }
        
        .warning {
            color: #e67e22;
            margin-top: 8px;
            font-size: 0.9em;
            padding: 12px;
            background: rgba(230, 126, 34, 0.1);
            border-radius: 6px;
            border-left: 4px solid #e67e22;
        }
        
        .admin-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .admin-controls button {
            width: auto;
            padding: 8px 15px;
            font-size: 0.8em;
        }
        
        .message-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: none;
            gap: 5px;
        }
        
        .message:hover .message-controls {
            display: flex;
        }
        
        .message-controls button {
            padding: 4px 8px;
            font-size: 0.7rem;
            width: auto;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #333;
            margin-bottom: 20px;
            background: rgba(40, 40, 40, 0.6);
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }
        
        .tab {
            padding: 16px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
            font-weight: 500;
            color: #aaa;
        }
        
        .tab:hover {
            background: rgba(60, 60, 60, 0.6);
            color: #fff;
        }
        
        .tab.active {
            border-bottom: 3px solid #4a76a8;
            color: #fff;
            background: rgba(30, 30, 30, 0.8);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .advertisement-alert {
            background: rgba(70, 30, 30, 0.6);
            padding: 16px;
            border-radius: 8px;
            margin: 12px 0;
            border-left: 4px solid #c0392b;
            animation: pulse-alert 2s infinite;
        }
        
        @keyframes pulse-alert {
            0%, 100% { box-shadow: 0 0 0 0 rgba(192, 57, 43, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(192, 57, 43, 0); }
            100% { box-shadow: 0 0 0 0 rgba(192, 57, 43, 0); }
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid #333;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #4a76a8;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 300;
            margin-bottom: 5px;
            color: #4a76a8;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #aaa;
        }
        
        .login-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            #app {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .welcome-title {
                font-size: 2.2rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .admin-controls {
                flex-direction: column;
            }
            
            .nav {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
        }
        
        @media (max-width: 480px) {
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #888;
        }
        
        .encryption-notice {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .encryption-icon {
            color: #2ecc71;
        }
        
        /* –°—Ç–∏–∫–µ—Ä—ã */
        .sticker-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .sticker {
            font-size: 2rem;
            cursor: pointer;
            transition: transform 0.2s;
            padding: 5px;
            border-radius: 5px;
        }
        
        .sticker:hover {
            transform: scale(1.2);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .sticker-message {
            font-size: 3rem;
            text-align: center;
            padding: 10px;
        }
        
        /* –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .private-message-indicator {
            font-size: 0.8rem;
            color: #27ae60;
            margin-left: 10px;
        }
        
        .chat-type-selector {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        
        .chat-type {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .chat-type.active {
            border-bottom: 2px solid #4a76a8;
            color: #4a76a8;
        }
        
        .private-chat-info {
            background: rgba(30, 60, 50, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 3px solid #27ae60;
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ */
        .file-upload {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            padding: 10px 15px;
            background: rgba(74, 118, 168, 0.2);
            border: 1px solid #4a76a8;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-label:hover {
            background: rgba(74, 118, 168, 0.4);
        }
        
        .uploaded-image {
            max-width: 300px;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 10px;
        }
        
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
        }
        
        .settings-section h3 {
            margin-bottom: 15px;
            color: #4a76a8;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        
        .setting-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #444;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #4a76a8;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* –†–µ–ø–æ—Ä—Ç—ã */
        .report-item {
            padding: 15px;
            margin: 10px 0;
            background: rgba(50, 50, 50, 0.6);
            border-radius: 8px;
            border-left: 4px solid #e67e22;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .report-reason {
            color: #e67e22;
            font-weight: 500;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: rgba(30, 30, 30, 0.95);
            border-radius: 8px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border: 1px solid #333;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .modal-buttons button {
            flex: 1;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .settings-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border: 1px solid #3a506b;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }
        
        .settings-button:hover {
            transform: scale(1.1) rotate(30deg);
        }
    </style>
</head>
<body>
    <div class="animated-bg" id="animated-bg"></div>
    
    <div id="app">
        <!-- –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω —Å –≤—ã–±–æ—Ä–æ–º –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="welcome-screen" class="container">
            <h1 class="welcome-title">SecureChat</h1>
            <p class="welcome-subtitle">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏</p>
            
            <div class="login-options">
                <div class="form-group">
                    <button id="login-btn">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</button>
                </div>
                <div class="form-group">
                    <button id="register-btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                <div class="form-group">
                    <button id="admin-btn" class="btn-admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</button>
                </div>
                <div class="form-group">
                    <button id="forgot-password-btn" class="btn-warning">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</button>
                </div>
            </div>
            
            <div class="security-badge">
                <span class="encryption-icon">üîí</span> –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã —Å–∫–≤–æ–∑–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
            </div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
        <div id="login-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
            <div class="form-group">
                <input type="text" id="login-username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
            </div>
            <div class="form-group">
                <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            </div>
            <div class="form-group">
                <button id="login-submit">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
            </div>
            <div class="form-group">
                <button id="login-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="login-error" class="error hidden"></div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="register-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏</h2>
            <div class="form-group">
                <input type="text" id="register-username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
            </div>
            <div class="form-group">
                <input type="email" id="register-email" placeholder="–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π email" required>
            </div>
            <div class="form-group">
                <input type="password" id="register-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            </div>
            <div class="form-group">
                <input type="password" id="register-confirm-password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è" required>
            </div>
            <div class="form-group">
                <button id="register-submit">–°–æ–∑–¥–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å</button>
            </div>
            <div class="form-group">
                <button id="register-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="register-error" class="error hidden"></div>
            <div id="register-success" class="success hidden"></div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div id="admin-login-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø</h2>
            <div class="form-group">
                <input type="password" id="admin-password" placeholder="–ö–ª—é—á –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" required>
            </div>
            <div class="form-group">
                <button id="admin-login-submit">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–æ—Å—Ç—É–ø</button>
            </div>
            <div class="form-group">
                <button id="admin-login-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="admin-login-error" class="error hidden"></div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è -->
        <div id="forgot-password-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h2>
            <div class="form-group">
                <input type="email" id="forgot-email" placeholder="–í–∞—à email" required>
            </div>
            <div class="form-group">
                <button id="forgot-submit">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </div>
            <div class="form-group">
                <button id="forgot-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="forgot-error" class="error hidden"></div>
            <div id="forgot-success" class="success hidden"></div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞ -->
        <div id="chat-interface" class="hidden">
            <div class="nav">
                <h2>SecureChat | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–∞–Ω–∞–ª</h2>
                <div>
                    <span id="current-user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    <button id="logout-btn">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å</button>
                </div>
            </div>
            
            <div class="chat-type-selector">
                <div class="chat-type active" data-chat-type="public">–û–±—â–∏–π —á–∞—Ç</div>
                <div class="chat-type" data-chat-type="private">–õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
            </div>
            
            <div id="public-chat" class="chat-tab">
                <div class="container">
                    <div id="chat-messages" class="chat-container">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    
                    <div class="file-upload">
                        <input type="file" id="file-input" class="file-input" accept="image/*">
                        <label for="file-input" class="file-label">üìé –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                        <span id="file-name"></span>
                    </div>
                    
                    <div class="sticker-selector">
                        <div class="sticker" data-sticker="üëç">üëç</div>
                        <div class="sticker" data-sticker="üëé">üëé</div>
                        <div class="sticker" data-sticker="üòä">üòä</div>
                        <div class="sticker" data-sticker="üò¢">üò¢</div>
                        <div class="sticker" data-sticker="üéâ">üéâ</div>
                        <div class="sticker" data-sticker="üî•">üî•</div>
                        <div class="sticker" data-sticker="‚úÖ">‚úÖ</div>
                        <div class="sticker" data-sticker="‚ùå">‚ùå</div>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <button id="send-message">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                        <button id="report-message" class="btn-warning" style="margin-top: 10px;">–ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                </div>
                
                <div class="container">
                    <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                    <ul id="online-users" class="user-list">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </ul>
                </div>
            </div>
            
            <div id="private-chat" class="chat-tab hidden">
                <div class="container">
                    <div class="private-chat-info">
                        –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –±–µ—Å–µ–¥—ã
                    </div>
                    
                    <div id="private-messages" class="chat-container">
                        <!-- –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    
                    <div class="form-group">
                        <select id="private-recipient">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>
                        </select>
                    </div>
                    
                    <div class="file-upload">
                        <input type="file" id="private-file-input" class="file-input" accept="image/*">
                        <label for="private-file-input" class="file-label">üìé –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                        <span id="private-file-name"></span>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="private-message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <button id="send-private-message">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
        <div id="admin-panel" class="hidden">
            <div class="nav">
                <h2>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π</h2>
                <button id="admin-logout">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å</button>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="total-users">0</div>
                    <div class="stat-label">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="online-users-count">0</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-messages">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="banned-users">0</div>
                    <div class="stat-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="users">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</div>
                <div class="tab" data-tab="messages">–ú–æ–¥–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                <div class="tab" data-tab="admin-chat">–°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                <div class="tab" data-tab="advertisements">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
                <div class="tab" data-tab="private-messages">–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                <div class="tab" data-tab="reports">–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
            </div>
            
            <div class="tab-content active" id="users-tab">
                <div class="container">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏</h3>
                    <ul id="admin-user-list" class="user-list">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞–¥–º–∏–Ω–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </ul>
                </div>
            </div>
            
            <div class="tab-content" id="messages-tab">
                <div class="container">
                    <h3>–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                    <div id="admin-messages" class="chat-container">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    <div class="form-group">
                        <button id="clear-all-messages" class="btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π</button>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="admin-chat-tab">
                <div class="container">
                    <h3>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                    <div class="form-group">
                        <select id="admin-message-type">
                            <option value="info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</option>
                            <option value="warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</option>
                            <option value="announcement">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <textarea id="admin-message-input" placeholder="–¢–µ–∫—Å—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <button id="send-admin-message" class="btn-warning">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="advertisements-tab">
                <div class="container">
                    <h3>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                    <div id="advertisement-alerts">
                        <!-- –û–ø–æ–≤–µ—â–µ–Ω–∏—è –æ —Ä–µ–∫–ª–∞–º–µ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="private-messages-tab">
                <div class="container">
                    <h3>–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                    <div class="form-group">
                        <select id="private-conversation-selector">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</option>
                        </select>
                    </div>
                    <div id="admin-private-messages" class="chat-container">
                        <!-- –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="reports-tab">
                <div class="container">
                    <h3>–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                    <div id="reports-list">
                        <!-- –°–ø–∏—Å–æ–∫ –∂–∞–ª–æ–± –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <div id="settings-panel" class="container hidden">
            <div class="nav">
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
                <button id="settings-back">–ù–∞–∑–∞–¥ –∫ —á–∞—Ç—É</button>
            </div>
            
            <div class="settings-section">
                <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                <div class="setting-item">
                    <span>–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                    <div class="setting-control">
                        <label class="switch">
                            <input type="checkbox" id="sound-notifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="setting-item">
                    <span>–í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                    <div class="setting-control">
                        <label class="switch">
                            <input type="checkbox" id="popup-notifications" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                <div class="setting-item">
                    <span>–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                    <div class="setting-control">
                        <label class="switch">
                            <input type="checkbox" id="dark-theme" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="setting-item">
                    <span>–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º</span>
                    <div class="setting-control">
                        <label class="switch">
                            <input type="checkbox" id="compact-mode">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</h3>
                <div class="setting-item">
                    <span>–°—Ç–∞—Ç—É—Å –æ–Ω–ª–∞–π–Ω</span>
                    <div class="setting-control">
                        <label class="switch">
                            <input type="checkbox" id="online-status" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div class="setting-item">
                    <span>–†–∞–∑—Ä–µ—à–∏—Ç—å –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
                    <div class="setting-control">
                        <label class="switch">
                            <input type="checkbox" id="allow-private-messages" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <button id="save-settings" class="btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button id="reset-settings" class="btn-warning">–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ -->
    <div id="logout-modal" class="modal">
        <div class="modal-content">
            <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞</h3>
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?</p>
            <div class="modal-buttons">
                <button id="confirm-logout" class="btn-danger">–í—ã–π—Ç–∏</button>
                <button id="cancel-logout">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∂–∞–ª–æ–±—ã -->
    <div id="report-modal" class="modal">
        <div class="modal-content">
            <h3>–ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ</h3>
            <div class="form-group">
                <select id="report-reason">
                    <option value="spam">–°–ø–∞–º</option>
                    <option value="harassment">–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è</option>
                    <option value="advertisement">–†–µ–∫–ª–∞–º–∞</option>
                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                </select>
            </div>
            <div class="form-group">
                <textarea id="report-description" placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É..." rows="3"></textarea>
            </div>
            <div class="modal-buttons">
                <button id="confirm-report" class="btn-warning">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∂–∞–ª–æ–±—É</button>
                <button id="cancel-report">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="settings-button" id="settings-button">‚öôÔ∏è</div>
    
    <script>
        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        class UserManager {
            constructor() {
                this.users = JSON.parse(localStorage.getItem('chatUsers')) || [];
                this.currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
                this.adminPassword = 'admin228';
                this.settings = JSON.parse(localStorage.getItem('chatSettings')) || {
                    soundNotifications: true,
                    popupNotifications: true,
                    darkTheme: true,
                    compactMode: false,
                    onlineStatus: true,
                    allowPrivateMessages: true
                };
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ localStorage
            saveUsers() {
                localStorage.setItem('chatUsers', JSON.stringify(this.users));
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            saveSettings() {
                localStorage.setItem('chatSettings', JSON.stringify(this.settings));
            }
            
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            register(username, email, password) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (this.users.find(user => user.username === username)) {
                    return { success: false, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' };
                }
                
                if (this.users.find(user => user.email === email)) {
                    return { success: false, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' };
                }
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const newUser = {
                    id: Date.now().toString(),
                    username,
                    email,
                    password,
                    isOnline: true,
                    isAdmin: false,
                    isBanned: false,
                    banReason: '',
                    registrationDate: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                };
                
                this.users.push(newUser);
                this.saveUsers();
                
                return { success: true, user: newUser };
            }
            
            // –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            login(username, password) {
                const user = this.users.find(u => u.username === username && u.password === password);
                
                if (!user) {
                    return { success: false, message: '–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å' };
                }
                
                if (user.isBanned) {
                    return { success: false, message: `–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ü—Ä–∏—á–∏–Ω–∞: ${user.banReason}` };
                }
                
                user.isOnline = true;
                user.lastLogin = new Date().toISOString();
                this.saveUsers();
                this.currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                return { success: true, user };
            }
            
            // –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            adminLogin(password) {
                if (password !== this.adminPassword) {
                    return { success: false, message: '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞' };
                }
                
                const adminUser = {
                    id: 'admin',
                    username: '–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                    isOnline: true,
                    isAdmin: true
                };
                
                this.currentUser = adminUser;
                localStorage.setItem('currentUser', JSON.stringify(adminUser));
                
                return { success: true, user: adminUser };
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
            resetPassword(email) {
                const user = this.users.find(u => u.email === email);
                if (!user) {
                    return { success: false, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω' };
                }
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω email —Å —Å—Å—ã–ª–∫–æ–π –¥–ª—è —Å–±—Ä–æ—Å–∞
                // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—Ö
                return { success: true, message: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –≤–∞—à email' };
            }
            
            // –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            logout() {
                if (this.currentUser && this.currentUser.id !== 'admin') {
                    const user = this.users.find(u => u.id === this.currentUser.id);
                    if (user) {
                        user.isOnline = false;
                        this.saveUsers();
                    }
                }
                
                this.currentUser = null;
                localStorage.removeItem('currentUser');
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            getOnlineUsers() {
                return this.users.filter(user => user.isOnline && !user.isBanned);
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤–∫–ª—é—á–∞—è –æ—Ñ–ª–∞–π–Ω)
            getAllUsers() {
                return this.users;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            getBannedUsers() {
                return this.users.filter(user => user.isBanned);
            }
            
            // –ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            banUser(userId, reason) {
                const user = this.users.find(u => u.id === userId);
                if (user) {
                    user.isBanned = true;
                    user.banReason = reason;
                    user.isOnline = false;
                    this.saveUsers();
                    return true;
                }
                return false;
            }
            
            // –†–∞–∑–±–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            unbanUser(userId) {
                const user = this.users.find(u => u.id === userId);
                if (user) {
                    user.isBanned = false;
                    user.banReason = '';
                    this.saveUsers();
                    return true;
                }
                return false;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            deleteUser(userId) {
                this.users = this.users.filter(user => user.id !== userId);
                this.saveUsers();
            }
        }

        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
        class MessageManager {
            constructor() {
                this.messages = JSON.parse(localStorage.getItem('chatMessages')) || [];
                this.privateMessages = JSON.parse(localStorage.getItem('privateMessages')) || [];
                this.reports = JSON.parse(localStorage.getItem('chatReports')) || [];
                this.advertisementKeywords = [
                    '–∫—É–ø–∏—Ç—å', '–ø—Ä–æ–¥–∞—Ç—å', '—Å–∫–∏–¥–∫–∞', '–∞–∫—Ü–∏—è', '–±–µ—Å–ø–ª–∞—Ç–Ω–æ', '—Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è',
                    '—Ä–µ–∫–ª–∞–º–∞', '–∑–∞–∫–∞–∑–∞—Ç—å', '—Ü–µ–Ω–∞', '–º–∞–≥–∞–∑–∏–Ω', '–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω', '–¥–æ—Å—Ç–∞–≤–∫–∞',
                    '–æ–ø—Ç–æ–º', '—Ä–æ–∑–Ω–∏—Ü–∞', '—Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞', '—Å–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ', '–ø—Ä–æ–º–æ–∫–æ–¥'
                ];
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
            saveMessages() {
                localStorage.setItem('chatMessages', JSON.stringify(this.messages));
                localStorage.setItem('privateMessages', JSON.stringify(this.privateMessages));
                localStorage.setItem('chatReports', JSON.stringify(this.reports));
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            addMessage(userId, username, content, isAdminMessage = false, messageType = 'user', image = null) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∫–ª–∞–º—É
                const isAdvertisement = this.checkForAdvertisement(content);
                
                const newMessage = {
                    id: Date.now().toString(),
                    userId,
                    username,
                    content,
                    isAdminMessage,
                    messageType,
                    isAdvertisement,
                    image,
                    timestamp: new Date().toISOString(),
                    isSticker: this.isSticker(content)
                };
                
                this.messages.push(newMessage);
                this.saveMessages();
                
                return newMessage;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∏–∫–µ—Ä
            isSticker(content) {
                // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏
                const emojiRegex = /^(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff]){1,3}$/;
                return emojiRegex.test(content.trim());
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∫–ª–∞–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            checkForAdvertisement(content) {
                if (!content) return false;
                const lowerContent = content.toLowerCase();
                return this.advertisementKeywords.some(keyword => 
                    lowerContent.includes(keyword.toLowerCase())
                );
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            getAllMessages() {
                return this.messages;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            getAdvertisementMessages() {
                return this.messages.filter(message => message.isAdvertisement);
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            getAdminMessages() {
                return this.messages.filter(message => message.isAdminMessage);
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            addPrivateMessage(senderId, senderName, recipientId, recipientName, content, image = null) {
                const newMessage = {
                    id: Date.now().toString(),
                    senderId,
                    senderName,
                    recipientId,
                    recipientName,
                    content,
                    image,
                    isSticker: this.isSticker(content),
                    timestamp: new Date().toISOString()
                };
                
                this.privateMessages.push(newMessage);
                this.saveMessages();
                
                return newMessage;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
            getPrivateMessages(user1Id, user2Id) {
                return this.privateMessages.filter(message => 
                    (message.senderId === user1Id && message.recipientId === user2Id) ||
                    (message.senderId === user2Id && message.recipientId === user1Id)
                );
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è –∞–¥–º–∏–Ω–∞)
            getAllPrivateMessages() {
                return this.privateMessages;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            getUserConversations(userId) {
                const conversations = {};
                
                this.privateMessages.forEach(message => {
                    if (message.senderId === userId || message.recipientId === userId) {
                        const otherUserId = message.senderId === userId ? message.recipientId : message.senderId;
                        const otherUserName = message.senderId === userId ? message.recipientName : message.senderName;
                        
                        if (!conversations[otherUserId]) {
                            conversations[otherUserId] = {
                                userId: otherUserId,
                                username: otherUserName,
                                lastMessage: message,
                                unread: 0
                            };
                        }
                        
                        if (message.timestamp > conversations[otherUserId].lastMessage.timestamp) {
                            conversations[otherUserId].lastMessage = message;
                        }
                    }
                });
                
                return Object.values(conversations);
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∂–∞–ª–æ–±—ã
            addReport(reporterId, reporterName, messageId, reason, description) {
                const newReport = {
                    id: Date.now().toString(),
                    reporterId,
                    reporterName,
                    messageId,
                    reason,
                    description,
                    timestamp: new Date().toISOString(),
                    resolved: false
                };
                
                this.reports.push(newReport);
                this.saveMessages();
                
                return newReport;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∂–∞–ª–æ–±
            getAllReports() {
                return this.reports;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            deleteMessage(messageId) {
                this.messages = this.messages.filter(message => message.id !== messageId);
                this.saveMessages();
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            deletePrivateMessage(messageId) {
                this.privateMessages = this.privateMessages.filter(message => message.id !== messageId);
                this.saveMessages();
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            editMessage(messageId, newContent) {
                const message = this.messages.find(m => m.id === messageId);
                if (message) {
                    message.content = newContent;
                    message.edited = true;
                    message.editTimestamp = new Date().toISOString();
                    this.saveMessages();
                    return true;
                }
                return false;
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            editPrivateMessage(messageId, newContent) {
                const message = this.privateMessages.find(m => m.id === messageId);
                if (message) {
                    message.content = newContent;
                    message.edited = true;
                    message.editTimestamp = new Date().toISOString();
                    this.saveMessages();
                    return true;
                }
                return false;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            clearAllMessages() {
                this.messages = [];
                this.saveMessages();
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            clearAdvertisementMessages() {
                this.messages = this.messages.filter(message => !message.isAdvertisement);
                this.saveMessages();
            }
        }

        // –ö–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        class ChatApp {
            constructor() {
                this.userManager = new UserManager();
                this.messageManager = new MessageManager();
                this.currentChatType = 'public'; // 'public' –∏–ª–∏ 'private'
                this.currentPrivateRecipient = null;
                this.selectedMessageForReport = null;
                this.init();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            init() {
                this.bindEvents();
                this.checkAuthStatus();
                this.setupTabs();
                this.setupChatTypes();
                this.createAnimatedBackground();
                this.loadSettings();
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ–Ω–∞
            createAnimatedBackground() {
                const bg = document.getElementById('animated-bg');
                const particlesCount = 50;
                
                for (let i = 0; i < particlesCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'bg-particle';
                    particle.style.left = `${Math.random() * 100}%`;
                    particle.style.top = `${Math.random() * 100}%`;
                    particle.style.animationDelay = `${Math.random() * 5}s`;
                    bg.appendChild(particle);
                }
                
                // –ê–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏
                document.addEventListener('mousemove', (e) => {
                    const x = (e.clientX / window.innerWidth) * 10;
                    const y = (e.clientY / window.innerHeight) * 10;
                    bg.style.transform = `translate(${x}px, ${y}px)`;
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            loadSettings() {
                const settings = this.userManager.settings;
                document.getElementById('sound-notifications').checked = settings.soundNotifications;
                document.getElementById('popup-notifications').checked = settings.popupNotifications;
                document.getElementById('dark-theme').checked = settings.darkTheme;
                document.getElementById('compact-mode').checked = settings.compactMode;
                document.getElementById('online-status').checked = settings.onlineStatus;
                document.getElementById('allow-private-messages').checked = settings.allowPrivateMessages;
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            saveSettings() {
                this.userManager.settings = {
                    soundNotifications: document.getElementById('sound-notifications').checked,
                    popupNotifications: document.getElementById('popup-notifications').checked,
                    darkTheme: document.getElementById('dark-theme').checked,
                    compactMode: document.getElementById('compact-mode').checked,
                    onlineStatus: document.getElementById('online-status').checked,
                    allowPrivateMessages: document.getElementById('allow-private-messages').checked
                };
                this.userManager.saveSettings();
                alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            }
            
            // –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫
            resetSettings() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?')) {
                    this.userManager.settings = {
                        soundNotifications: true,
                        popupNotifications: true,
                        darkTheme: true,
                        compactMode: false,
                        onlineStatus: true,
                        allowPrivateMessages: true
                    };
                    this.userManager.saveSettings();
                    this.loadSettings();
                    alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã');
                }
            }
            
            // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
            bindEvents() {
                // –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
                document.getElementById('login-btn').addEventListener('click', () => this.showScreen('login-form'));
                document.getElementById('register-btn').addEventListener('click', () => this.showScreen('register-form'));
                document.getElementById('admin-btn').addEventListener('click', () => this.showScreen('admin-login-form'));
                document.getElementById('forgot-password-btn').addEventListener('click', () => this.showScreen('forgot-password-form'));
                
                // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
                document.getElementById('login-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('login-submit').addEventListener('click', () => this.handleLogin());
                
                // –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                document.getElementById('register-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('register-submit').addEventListener('click', () => this.handleRegister());
                
                // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                document.getElementById('admin-login-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('admin-login-submit').addEventListener('click', () => this.handleAdminLogin());
                
                // –§–æ—Ä–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
                document.getElementById('forgot-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('forgot-submit').addEventListener('click', () => this.handleForgotPassword());
                
                // –ß–∞—Ç
                document.getElementById('logout-btn').addEventListener('click', () => this.showLogoutConfirmation());
                document.getElementById('send-message').addEventListener('click', () => this.sendMessage());
                document.getElementById('message-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                
                // –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                document.getElementById('send-private-message').addEventListener('click', () => this.sendPrivateMessage());
                document.getElementById('private-recipient').addEventListener('change', (e) => {
                    this.currentPrivateRecipient = e.target.value;
                    this.loadPrivateMessages();
                });
                
                // –°—Ç–∏–∫–µ—Ä—ã
                document.querySelectorAll('.sticker').forEach(sticker => {
                    sticker.addEventListener('click', (e) => {
                        const stickerValue = e.target.getAttribute('data-sticker');
                        this.sendSticker(stickerValue);
                    });
                });
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
                document.getElementById('file-input').addEventListener('change', (e) => this.handleFileUpload(e, false));
                document.getElementById('private-file-input').addEventListener('change', (e) => this.handleFileUpload(e, true));
                
                // –ñ–∞–ª–æ–±—ã
                document.getElementById('report-message').addEventListener('click', () => this.showReportModal());
                document.getElementById('confirm-report').addEventListener('click', () => this.submitReport());
                document.getElementById('cancel-report').addEventListener('click', () => this.hideModal('report-modal'));
                
                // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞
                document.getElementById('confirm-logout').addEventListener('click', () => this.handleLogout());
                document.getElementById('cancel-logout').addEventListener('click', () => this.hideModal('logout-modal'));
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                document.getElementById('settings-button').addEventListener('click', () => this.showSettings());
                document.getElementById('settings-back').addEventListener('click', () => this.showChat());
                document.getElementById('save-settings').addEventListener('click', () => this.saveSettings());
                document.getElementById('reset-settings').addEventListener('click', () => this.resetSettings());
                
                // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                document.getElementById('admin-logout').addEventListener('click', () => this.showLogoutConfirmation());
                document.getElementById('clear-all-messages').addEventListener('click', () => this.clearAllMessages());
                document.getElementById('send-admin-message').addEventListener('click', () => this.sendAdminMessage());
                document.getElementById('private-conversation-selector').addEventListener('change', (e) => {
                    this.loadAdminPrivateMessages(e.target.value);
                });
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∫–ª–∞–¥–æ–∫
            setupTabs() {
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        
                        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É
                        tab.classList.add('active');
                        document.getElementById(`${tabId}-tab`).classList.add('active');
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
                        if (tabId === 'users') {
                            this.loadAdminUserList();
                        } else if (tabId === 'messages') {
                            this.loadAdminMessages();
                        } else if (tabId === 'advertisements') {
                            this.loadAdvertisementAlerts();
                        } else if (tabId === 'private-messages') {
                            this.loadPrivateConversationsForAdmin();
                        } else if (tabId === 'reports') {
                            this.loadReports();
                        }
                    });
                });
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∏–ø–æ–≤ —á–∞—Ç–∞
            setupChatTypes() {
                document.querySelectorAll('.chat-type').forEach(type => {
                    type.addEventListener('click', () => {
                        const chatType = type.getAttribute('data-chat-type');
                        
                        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
                        document.querySelectorAll('.chat-type').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.chat-tab').forEach(t => t.classList.add('hidden'));
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç–∏–ø—É
                        type.classList.add('active');
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç
                        if (chatType === 'public') {
                            document.getElementById('public-chat').classList.remove('hidden');
                            this.currentChatType = 'public';
                        } else {
                            document.getElementById('private-chat').classList.remove('hidden');
                            this.currentChatType = 'private';
                            this.loadPrivateRecipients();
                        }
                    });
                });
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            checkAuthStatus() {
                if (this.userManager.currentUser) {
                    if (this.userManager.currentUser.isAdmin) {
                        this.showAdminPanel();
                    } else {
                        this.showChat();
                    }
                } else {
                    this.showScreen('welcome-screen');
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
            showScreen(screenId) {
                document.querySelectorAll('#app > div').forEach(div => {
                    div.classList.add('hidden');
                });
                document.getElementById(screenId).classList.remove('hidden');
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            showSettings() {
                this.showScreen('settings-panel');
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —á–∞—Ç
            showChat() {
                this.showScreen('chat-interface');
                document.getElementById('current-user').textContent = this.userManager.currentUser.username;
                this.loadMessages();
                this.loadOnlineUsers();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
                setInterval(() => {
                    this.loadOnlineUsers();
                }, 5000);
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
            handleLogin() {
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                const errorElement = document.getElementById('login-error');
                
                if (!username || !password) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                const result = this.userManager.login(username, password);
                
                if (result.success) {
                    this.showChat();
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            handleRegister() {
                const username = document.getElementById('register-username').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm-password').value;
                const errorElement = document.getElementById('register-error');
                const successElement = document.getElementById('register-success');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                errorElement.classList.add('hidden');
                successElement.classList.add('hidden');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π
                if (!username || !email || !password || !confirmPassword) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
                if (password !== confirmPassword) {
                    errorElement.textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const result = this.userManager.register(username, email, password);
                
                if (result.success) {
                    successElement.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏.';
                    successElement.classList.remove('hidden');
                    
                    // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
                    document.getElementById('register-username').value = '';
                    document.getElementById('register-email').value = '';
                    document.getElementById('register-password').value = '';
                    document.getElementById('register-confirm-password').value = '';
                    
                    // –í–æ–∑–≤—Ä–∞—Ç –∫ —ç–∫—Ä–∞–Ω—É –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        this.showScreen('login-form');
                    }, 2000);
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            handleAdminLogin() {
                const password = document.getElementById('admin-password').value;
                const errorElement = document.getElementById('admin-login-error');
                
                if (!password) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                const result = this.userManager.adminLogin(password);
                
                if (result.success) {
                    this.showAdminPanel();
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
            handleForgotPassword() {
                const email = document.getElementById('forgot-email').value;
                const errorElement = document.getElementById('forgot-error');
                const successElement = document.getElementById('forgot-success');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                errorElement.classList.add('hidden');
                successElement.classList.add('hidden');
                
                if (!email) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ email';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                const result = this.userManager.resetPassword(email);
                
                if (result.success) {
                    successElement.textContent = result.message;
                    successElement.classList.remove('hidden');
                    
                    // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
                    document.getElementById('forgot-email').value = '';
                    
                    // –í–æ–∑–≤—Ä–∞—Ç –∫ —ç–∫—Ä–∞–Ω—É –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        this.showScreen('login-form');
                    }, 3000);
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            showAdminPanel() {
                this.showScreen('admin-panel');
                this.updateStats();
                this.loadAdminUserList();
                this.loadAdminMessages();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
                setInterval(() => {
                    this.updateStats();
                    this.loadAdminUserList();
                    this.loadAdminMessages();
                }, 5000);
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStats() {
                document.getElementById('total-users').textContent = this.userManager.getAllUsers().length;
                document.getElementById('online-users-count').textContent = this.userManager.getOnlineUsers().length;
                document.getElementById('total-messages').textContent = this.messageManager.getAllMessages().length;
                document.getElementById('banned-users').textContent = this.userManager.getBannedUsers().length;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç
            loadMessages() {
                const messagesContainer = document.getElementById('chat-messages');
                const messages = this.messageManager.getAllMessages();
                
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = this.createMessageElement(message, false);
                    messagesContainer.appendChild(messageElement);
                });
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            createMessageElement(message, isPrivate = false) {
                const messageElement = document.createElement('div');
                messageElement.className = 'message';
                messageElement.dataset.messageId = message.id;
                
                if (message.userId === this.userManager.currentUser.id || 
                    (isPrivate && message.senderId === this.userManager.currentUser.id)) {
                    messageElement.classList.add('my-message');
                } else if (message.isAdminMessage) {
                    messageElement.classList.add('admin-message');
                } else if (message.isAdvertisement) {
                    messageElement.classList.add('advertisement-message');
                } else if (isPrivate) {
                    messageElement.classList.add('private-message');
                }
                
                let headerText = message.username;
                if (message.isAdminMessage) headerText += ' (–°–∏—Å—Ç–µ–º–∞)';
                if (isPrivate) headerText += ' ‚Üí ' + (message.senderId === this.userManager.currentUser.id ? message.recipientName : message.senderName);
                
                let content = '';
                if (message.image) {
                    content += `<img src="${message.image}" class="uploaded-image" alt="–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
                }
                if (message.isSticker) {
                    content += `<div class="sticker-message">${message.content}</div>`;
                } else if (message.content) {
                    content += `<div class="message-content">${this.escapeHtml(message.content)}</div>`;
                }
                
                if (message.edited) {
                    content += `<div class="edited-indicator">(–∏–∑–º–µ–Ω–µ–Ω–æ)</div>`;
                }
                
                messageElement.innerHTML = `
                    <div class="message-header">
                        <span>${headerText}</span>
                        <span>${new Date(message.timestamp).toLocaleString()}</span>
                    </div>
                    ${content}
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å–≤–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
                if ((message.userId === this.userManager.currentUser.id && !isPrivate) || 
                    (isPrivate && message.senderId === this.userManager.currentUser.id)) {
                    const messageControls = document.createElement('div');
                    messageControls.className = 'message-controls';
                    messageControls.innerHTML = `
                        <button class="edit-message" data-message-id="${message.id}">‚úèÔ∏è</button>
                        <button class="delete-message" data-message-id="${message.id}">üóëÔ∏è</button>
                    `;
                    messageElement.appendChild(messageControls);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
                    messageControls.querySelector('.edit-message').addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.editMessage(message.id, isPrivate);
                    });
                    
                    messageControls.querySelector('.delete-message').addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.deleteMessage(message.id, isPrivate);
                    });
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ —á—É–∂–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                if ((message.userId !== this.userManager.currentUser.id && !isPrivate) || 
                    (isPrivate && message.senderId !== this.userManager.currentUser.id)) {
                    messageElement.addEventListener('click', () => {
                        this.selectedMessageForReport = message.id;
                    });
                }
                
                return messageElement;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            loadOnlineUsers() {
                const usersContainer = document.getElementById('online-users');
                const allUsers = this.userManager.getAllUsers();
                
                usersContainer.innerHTML = '';
                
                allUsers.forEach(user => {
                    if (user.id === this.userManager.currentUser.id) return;
                    
                    const userElement = document.createElement('li');
                    const indicator = user.isOnline ? 
                        '<span class="online-indicator"></span>' : 
                        '<span class="offline-indicator"></span>';
                    
                    userElement.innerHTML = `
                        <span>${indicator}${user.username}</span>
                        ${user.isAdmin ? '<span class="admin-badge">–ê–¥–º–∏–Ω</span>' : ''}
                        ${user.isBanned ? '<span class="banned-badge">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>' : ''}
                    `;
                    usersContainer.appendChild(userElement);
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–≤–∫–ª—é—á–∞—è –æ—Ñ–ª–∞–π–Ω)
            loadPrivateRecipients() {
                const recipientSelect = document.getElementById('private-recipient');
                const allUsers = this.userManager.getAllUsers();
                
                recipientSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>';
                
                allUsers.forEach(user => {
                    if (user.id === this.userManager.currentUser.id) return;
                    if (user.isBanned) return;
                    
                    const option = document.createElement('option');
                    option.value = user.id;
                    const status = user.isOnline ? ' (–æ–Ω–ª–∞–π–Ω)' : ' (–æ—Ñ–ª–∞–π–Ω)';
                    option.textContent = user.username + (user.isAdmin ? ' (–ê–¥–º–∏–Ω)' : '') + status;
                    recipientSelect.appendChild(option);
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            loadPrivateMessages() {
                if (!this.currentPrivateRecipient) return;
                
                const messagesContainer = document.getElementById('private-messages');
                const messages = this.messageManager.getPrivateMessages(
                    this.userManager.currentUser.id, 
                    this.currentPrivateRecipient
                );
                
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = this.createMessageElement(message, true);
                    messagesContainer.appendChild(messageElement);
                });
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
            handleFileUpload(event, isPrivate) {
                const file = event.target.files[0];
                if (!file) return;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª —è–≤–ª—è–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
                if (!file.type.match('image.*')) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = e.target.result;
                    
                    if (isPrivate) {
                        document.getElementById('private-file-name').textContent = file.name;
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                    } else {
                        document.getElementById('file-name').textContent = file.name;
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ–±—â–∏–π —á–∞—Ç
                    }
                };
                reader.readAsDataURL(file);
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            sendMessage() {
                const messageInput = document.getElementById('message-input');
                const content = messageInput.value.trim();
                const fileInput = document.getElementById('file-input');
                let image = null;
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        image = e.target.result;
                        this.messageManager.addMessage(
                            this.userManager.currentUser.id,
                            this.userManager.currentUser.username,
                            content,
                            false,
                            'user',
                            image
                        );
                        
                        messageInput.value = '';
                        fileInput.value = '';
                        document.getElementById('file-name').textContent = '';
                        this.loadMessages();
                    };
                    reader.readAsDataURL(file);
                } else {
                    if (!content) return;
                    
                    this.messageManager.addMessage(
                        this.userManager.currentUser.id,
                        this.userManager.currentUser.username,
                        content
                    );
                    
                    messageInput.value = '';
                    this.loadMessages();
                }
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∏–∫–µ—Ä–∞
            sendSticker(sticker) {
                this.messageManager.addMessage(
                    this.userManager.currentUser.id,
                    this.userManager.currentUser.username,
                    sticker
                );
                
                this.loadMessages();
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            sendPrivateMessage() {
                if (!this.currentPrivateRecipient) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è');
                    return;
                }
                
                const messageInput = document.getElementById('private-message-input');
                const content = messageInput.value.trim();
                const fileInput = document.getElementById('private-file-input');
                let image = null;
                
                const recipient = this.userManager.users.find(u => u.id === this.currentPrivateRecipient);
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        image = e.target.result;
                        this.messageManager.addPrivateMessage(
                            this.userManager.currentUser.id,
                            this.userManager.currentUser.username,
                            this.currentPrivateRecipient,
                            recipient.username,
                            content,
                            image
                        );
                        
                        messageInput.value = '';
                        fileInput.value = '';
                        document.getElementById('private-file-name').textContent = '';
                        this.loadPrivateMessages();
                    };
                    reader.readAsDataURL(file);
                } else {
                    if (!content) return;
                    
                    this.messageManager.addPrivateMessage(
                        this.userManager.currentUser.id,
                        this.userManager.currentUser.username,
                        this.currentPrivateRecipient,
                        recipient.username,
                        content
                    );
                    
                    messageInput.value = '';
                    this.loadPrivateMessages();
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            showModal(modalId) {
                document.getElementById(modalId).style.display = 'flex';
            }
            
            // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            hideModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞
            showLogoutConfirmation() {
                this.showModal('logout-modal');
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∂–∞–ª–æ–±—ã
            showReportModal() {
                if (!this.selectedMessageForReport) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è');
                    return;
                }
                this.showModal('report-modal');
            }
            
            // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∂–∞–ª–æ–±—É
            submitReport() {
                const reason = document.getElementById('report-reason').value;
                const description = document.getElementById('report-description').value;
                
                if (!description) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É');
                    return;
                }
                
                this.messageManager.addReport(
                    this.userManager.currentUser.id,
                    this.userManager.currentUser.username,
                    this.selectedMessageForReport,
                    reason,
                    description
                );
                
                this.hideModal('report-modal');
                document.getElementById('report-description').value = '';
                this.selectedMessageForReport = null;
                alert('–ñ–∞–ª–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∂–∞–ª–æ–± –¥–ª—è –∞–¥–º–∏–Ω–∞
            loadReports() {
                const reportsContainer = document.getElementById('reports-list');
                const reports = this.messageManager.getAllReports();
                
                reportsContainer.innerHTML = '';
                
                if (reports.length === 0) {
                    reportsContainer.innerHTML = '<p>–ñ–∞–ª–æ–±—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>';
                    return;
                }
                
                reports.forEach(report => {
                    const reportElement = document.createElement('div');
                    reportElement.className = 'report-item';
                    
                    reportElement.innerHTML = `
                        <div class="report-header">
                            <span class="report-reason">${this.getReportReasonText(report.reason)}</span>
                            <span>${new Date(report.timestamp).toLocaleString()}</span>
                        </div>
                        <div><strong>–û—Ç:</strong> ${report.reporterName}</div>
                        <div><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${report.description}</div>
                        <div class="admin-controls">
                            <button class="btn-danger resolve-report" data-report-id="${report.id}">–†–µ—à–µ–Ω–æ</button>
                            <button class="btn-warning view-reported-message" data-message-id="${report.messageId}">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                        </div>
                    `;
                    
                    reportsContainer.appendChild(reportElement);
                });
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.resolve-report').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const reportId = e.target.getAttribute('data-report-id');
                        this.resolveReport(reportId);
                    });
                });
                
                document.querySelectorAll('.view-reported-message').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const messageId = e.target.getAttribute('data-message-id');
                        this.viewReportedMessage(messageId);
                    });
                });
            }
            
            // –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –ø—Ä–∏—á–∏–Ω—ã –∂–∞–ª–æ–±—ã
            getReportReasonText(reason) {
                const reasons = {
                    'spam': '–°–ø–∞–º',
                    'harassment': '–û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è',
                    'advertisement': '–†–µ–∫–ª–∞–º–∞',
                    'other': '–î—Ä—É–≥–æ–µ'
                };
                return reasons[reason] || reason;
            }
            
            // –†–µ—à–∏—Ç—å –∂–∞–ª–æ–±—É
            resolveReport(reportId) {
                const report = this.messageManager.reports.find(r => r.id === reportId);
                if (report) {
                    report.resolved = true;
                    this.messageManager.saveMessages();
                    this.loadReports();
                }
            }
            
            // –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∂–∞–ª–æ–≤–∞–ª–∏—Å—å
            viewReportedMessage(messageId) {
                // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –Ω–∞–π—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
                document.querySelector('[data-tab="messages"]').click();
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è
                alert(`–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏—è —Å ID: ${messageId}`);
            }
            
            // –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏ —Ç.–¥.)
            // ... (–æ–Ω–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
            
            // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
            handleLogout() {
                this.userManager.logout();
                this.hideModal('logout-modal');
                this.showScreen('welcome-screen');
            }
            
            // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        document.addEventListener('DOMContentLoaded', () => {
            new ChatApp();
        });
    </script>
</body>
</html>