<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureChat | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 50%, #0c0c0c 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        #app {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 8px;
            border: 1px solid #333;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å —Å–µ—Ä—å–µ–∑–Ω—ã–º —Ñ–æ–Ω–æ–º */
        #welcome-screen {
            background: 
                radial-gradient(circle at 20% 80%, rgba(40, 40, 40, 0.8) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(60, 60, 60, 0.6) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            text-align: center;
            padding: 60px 40px;
            position: relative;
            overflow: hidden;
            border: 1px solid #333;
        }
        
        .welcome-title {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 2px;
            color: #ffffff;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        
        .welcome-subtitle {
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: #b0b0b0;
            font-weight: 300;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .security-badge {
            display: inline-block;
            background: rgba(0, 100, 0, 0.2);
            border: 1px solid #2a7a2a;
            color: #4CAF50;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-top: 20px;
        }
        
        h1, h2, h3 {
            margin-bottom: 20px;
            color: #ffffff;
            font-weight: 400;
        }
        
        h1 {
            border-bottom: 1px solid #333;
            padding-bottom: 15px;
        }
        
        input, textarea, button, select {
            padding: 14px 16px;
            margin: 10px 0;
            border: 1px solid #444;
            border-radius: 6px;
            width: 100%;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(40, 40, 40, 0.8);
            color: #e0e0e0;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #4a76a8;
            box-shadow: 0 0 0 2px rgba(74, 118, 168, 0.2);
        }
        
        input::placeholder, textarea::placeholder {
            color: #888;
        }
        
        button {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            border: 1px solid #3a506b;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-size: 0.9rem;
        }
        
        button:hover {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            border-color: #4a76a8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
            border-color: #a2352a;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            border-color: #219653;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #d35400 0%, #e67e22 100%);
            border-color: #b34700;
        }
        
        .btn-admin {
            background: linear-gradient(135deg, #8e44ad 0%, #9b59b6 100%);
            border-color: #7d3c98;
        }
        
        .btn-premium {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border-color: #daa520;
            color: #000;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .hidden {
            display: none;
        }
        
        .message {
            padding: 16px;
            margin: 12px 0;
            border-radius: 8px;
            background: rgba(50, 50, 50, 0.6);
            border-left: 4px solid #444;
            transition: all 0.2s ease;
            position: relative;
        }
        
        .message:hover {
            background: rgba(60, 60, 60, 0.8);
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: #aaa;
        }
        
        .message-content {
            word-wrap: break-word;
            line-height: 1.5;
        }
        
        .my-message {
            background: rgba(30, 50, 70, 0.6);
            border-left: 4px solid #4a76a8;
        }
        
        .admin-message {
            background: rgba(70, 30, 70, 0.6);
            border-left: 4px solid #8e44ad;
        }
        
        .advertisement-message {
            background: rgba(70, 30, 30, 0.6);
            border-left: 4px solid #c0392b;
        }
        
        .private-message {
            background: rgba(30, 60, 50, 0.6);
            border-left: 4px solid #27ae60;
        }
        
        .premium-user {
            font-weight: bold;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .premium-badge {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #000;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .chat-container {
            height: 450px;
            overflow-y: auto;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background: rgba(20, 20, 20, 0.6);
        }
        
        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
        .chat-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-container::-webkit-scrollbar-track {
            background: rgba(40, 40, 40, 0.5);
            border-radius: 4px;
        }
        
        .chat-container::-webkit-scrollbar-thumb {
            background: #4a76a8;
            border-radius: 4px;
        }
        
        .user-list {
            list-style-type: none;
            margin-top: 10px;
        }
        
        .user-list li {
            padding: 12px 16px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .user-list li:hover {
            background: rgba(50, 50, 50, 0.6);
        }
        
        .user-list li:last-child {
            border-bottom: none;
        }
        
        .admin-badge {
            background: #8e44ad;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .banned-badge {
            background: #c0392b;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .online-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #2ecc71;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .offline-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #95a5a6;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        
        .nav h2 {
            margin-bottom: 0;
            color: #ffffff;
            font-weight: 300;
        }
        
        .nav button {
            width: auto;
            padding: 10px 20px;
        }
        
        .error {
            color: #e74c3c;
            margin-top: 8px;
            font-size: 0.9em;
            padding: 12px;
            background: rgba(231, 76, 60, 0.1);
            border-radius: 6px;
            border-left: 4px solid #e74c3c;
        }
        
        .success {
            color: #2ecc71;
            margin-top: 8px;
            font-size: 0.9em;
            padding: 12px;
            background: rgba(46, 204, 113, 0.1);
            border-radius: 6px;
            border-left: 4px solid #2ecc71;
        }
        
        .warning {
            color: #e67e22;
            margin-top: 8px;
            font-size: 0.9em;
            padding: 12px;
            background: rgba(230, 126, 34, 0.1);
            border-radius: 6px;
            border-left: 4px solid #e67e22;
        }
        
        .admin-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .admin-controls button {
            width: auto;
            padding: 8px 15px;
            font-size: 0.8em;
        }
        
        .message-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: none;
            gap: 5px;
        }
        
        .message:hover .message-controls {
            display: flex;
        }
        
        .message-controls button {
            padding: 4px 8px;
            font-size: 0.7rem;
            width: auto;
            background: rgba(0,0,0,0.5);
            border: 1px solid #555;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #333;
            margin-bottom: 20px;
            background: rgba(40, 40, 40, 0.6);
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }
        
        .tab {
            padding: 16px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
            font-weight: 500;
            color: #aaa;
        }
        
        .tab:hover {
            background: rgba(60, 60, 60, 0.6);
            color: #fff;
        }
        
        .tab.active {
            border-bottom: 3px solid #4a76a8;
            color: #fff;
            background: rgba(30, 30, 30, 0.8);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .advertisement-alert {
            background: rgba(70, 30, 30, 0.6);
            padding: 16px;
            border-radius: 8px;
            margin: 12px 0;
            border-left: 4px solid #c0392b;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid #333;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: #4a76a8;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 300;
            margin-bottom: 5px;
            color: #4a76a8;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #aaa;
        }
        
        .login-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            #app {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .welcome-title {
                font-size: 2.2rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .admin-controls {
                flex-direction: column;
            }
            
            .nav {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
        }
        
        @media (max-width: 480px) {
            .welcome-title {
                font-size: 1.8rem;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #888;
        }
        
        .encryption-notice {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .encryption-icon {
            color: #2ecc71;
        }
        
        /* –°—Ç–∏–∫–µ—Ä—ã */
        .sticker-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .sticker {
            font-size: 2rem;
            cursor: pointer;
            transition: transform 0.2s;
            padding: 5px;
            border-radius: 5px;
        }
        
        .sticker:hover {
            transform: scale(1.2);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .sticker-message {
            font-size: 3rem;
            text-align: center;
            padding: 10px;
        }
        
        /* –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .private-message-indicator {
            font-size: 0.8rem;
            color: #27ae60;
            margin-left: 10px;
        }
        
        .chat-type-selector {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
        }
        
        .chat-type {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .chat-type.active {
            border-bottom: 2px solid #4a76a8;
            color: #4a76a8;
        }
        
        .private-chat-info {
            background: rgba(30, 60, 50, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 3px solid #27ae60;
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ */
        .file-upload {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .file-upload input {
            flex: 1;
        }
        
        .image-message {
            max-width: 300px;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 5px;
        }
        
        .report-message {
            background: rgba(231, 76, 60, 0.1);
            border-left: 4px solid #e74c3c;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            border: 1px solid #333;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .modal-buttons button {
            flex: 1;
        }
        
        .forgot-password-link {
            text-align: center;
            margin-top: 15px;
            color: #4a76a8;
            cursor: pointer;
            text-decoration: underline;
        }
        
        .report-button {
            background: transparent;
            border: none;
            color: #e74c3c;
            cursor: pointer;
            font-size: 0.8rem;
            padding: 2px 5px;
        }
        
        .password-display {
            font-family: monospace;
            background: rgba(0,0,0,0.3);
            padding: 2px 5px;
            border-radius: 3px;
            margin-left: 5px;
        }
        
        .show-password-btn {
            background: transparent;
            border: 1px solid #555;
            padding: 2px 6px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        
        .ban-time-controls {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .ban-time-controls input {
            flex: 2;
        }
        
        .ban-time-controls select {
            flex: 1;
        }
        
        .time-remaining {
            font-size: 0.8rem;
            color: #e67e22;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω —Å –≤—ã–±–æ—Ä–æ–º –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="welcome-screen" class="container">
            <h1 class="welcome-title">SecureChat</h1>
            <p class="welcome-subtitle">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏</p>
            
            <div class="login-options">
                <div class="form-group">
                    <button id="login-btn">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</button>
                </div>
                <div class="form-group">
                    <button id="register-btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                <div class="form-group">
                    <button id="admin-btn" class="btn-admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</button>
                </div>
            </div>
            
            <div class="security-badge">
                <span class="encryption-icon">üîí</span> –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã —Å–∫–≤–æ–∑–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
            </div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
        <div id="login-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
            <div class="form-group">
                <input type="text" id="login-username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
            </div>
            <div class="form-group">
                <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            </div>
            <div class="form-group">
                <button id="login-submit">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
            </div>
            <div class="form-group">
                <button id="login-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="login-error" class="error hidden"></div>
            <div class="forgot-password-link" id="forgot-password-btn">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è -->
        <div id="forgot-password-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h2>
            <div class="form-group">
                <input type="email" id="recovery-email" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email" required>
            </div>
            <div class="form-group">
                <button id="recover-password">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </div>
            <div class="form-group">
                <button id="recovery-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="recovery-error" class="error hidden"></div>
            <div id="recovery-success" class="success hidden"></div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="register-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏</h2>
            <div class="form-group">
                <input type="text" id="register-username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
            </div>
            <div class="form-group">
                <input type="email" id="register-email" placeholder="–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π email" required>
            </div>
            <div class="form-group">
                <input type="password" id="register-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            </div>
            <div class="form-group">
                <input type="password" id="register-confirm-password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è" required>
            </div>
            <div class="form-group">
                <button id="register-submit">–°–æ–∑–¥–∞—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å</button>
            </div>
            <div class="form-group">
                <button id="register-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="register-error" class="error hidden"></div>
            <div id="register-success" class="success hidden"></div>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div id="admin-login-form" class="container hidden">
            <div class="status-bar">
                <div class="encryption-notice">
                    <span class="encryption-icon">üîí</span> –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                </div>
                <div>SecureChat v2.1</div>
            </div>
            
            <h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø</h2>
            <div class="form-group">
                <input type="password" id="admin-password" placeholder="–ö–ª—é—á –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" required>
            </div>
            <div class="form-group">
                <button id="admin-login-submit">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–æ—Å—Ç—É–ø</button>
            </div>
            <div class="form-group">
                <button id="admin-login-back">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="admin-login-error" class="error hidden"></div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞ -->
        <div id="chat-interface" class="hidden">
            <div class="nav">
                <h2>SecureChat | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–∞–Ω–∞–ª</h2>
                <div>
                    <span id="current-user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    <button id="logout-btn">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å</button>
                </div>
            </div>
            
            <div class="chat-type-selector">
                <div class="chat-type active" data-chat-type="public">–û–±—â–∏–π —á–∞—Ç</div>
                <div class="chat-type" data-chat-type="private">–õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
            </div>
            
            <div id="public-chat" class="chat-tab">
                <div class="container">
                    <div id="chat-messages" class="chat-container">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    
                    <div class="file-upload">
                        <input type="file" id="image-upload" accept="image/*">
                        <button id="upload-image-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
                    </div>
                    
                    <div class="sticker-selector">
                        <div class="sticker" data-sticker="üëç">üëç</div>
                        <div class="sticker" data-sticker="üëé">üëé</div>
                        <div class="sticker" data-sticker="üòä">üòä</div>
                        <div class="sticker" data-sticker="üò¢">üò¢</div>
                        <div class="sticker" data-sticker="üéâ">üéâ</div>
                        <div class="sticker" data-sticker="üî•">üî•</div>
                        <div class="sticker" data-sticker="‚úÖ">‚úÖ</div>
                        <div class="sticker" data-sticker="‚ùå">‚ùå</div>
                        <div class="sticker" data-sticker="‚ù§Ô∏è">‚ù§Ô∏è</div>
                        <div class="sticker" data-sticker="üòÇ">üòÇ</div>
                        <div class="sticker" data-sticker="üòç">üòç</div>
                        <div class="sticker" data-sticker="ü§î">ü§î</div>
                        <div class="sticker" data-sticker="üëè">üëè</div>
                        <div class="sticker" data-sticker="üôè">üôè</div>
                        <div class="sticker" data-sticker="üíØ">üíØ</div>
                        <div class="sticker" data-sticker="üöÄ">üöÄ</div>
                        <div class="sticker" data-sticker="‚≠ê">‚≠ê</div>
                        <div class="sticker" data-sticker="üéØ">üéØ</div>
                        <div class="sticker" data-sticker="üèÜ">üèÜ</div>
                        <div class="sticker" data-sticker="üëë">üëë</div>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <button id="send-message">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                </div>
                
                <div class="container">
                    <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                    <ul id="online-users" class="user-list">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </ul>
                </div>
            </div>
            
            <div id="private-chat" class="chat-tab hidden">
                <div class="container">
                    <div class="private-chat-info">
                        –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –±–µ—Å–µ–¥—ã
                    </div>
                    
                    <div id="private-messages" class="chat-container">
                        <!-- –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    
                    <div class="file-upload">
                        <input type="file" id="private-image-upload" accept="image/*">
                        <button id="upload-private-image-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
                    </div>
                    
                    <div class="form-group">
                        <select id="private-recipient">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="private-message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <button id="send-private-message">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
        <div id="admin-panel" class="hidden">
            <div class="nav">
                <h2>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π</h2>
                <button id="admin-logout">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ–∞–Ω—Å</button>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="total-users">0</div>
                    <div class="stat-label">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="online-users-count">0</div>
                    <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-messages">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="banned-users">0</div>
                    <div class="stat-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="users">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</div>
                <div class="tab" data-tab="messages">–ú–æ–¥–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                <div class="tab" data-tab="admin-chat">–°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                <div class="tab" data-tab="advertisements">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
                <div class="tab" data-tab="reports">–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                <div class="tab" data-tab="private-messages">–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π</div>
            </div>
            
            <div class="tab-content active" id="users-tab">
                <div class="container">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏</h3>
                    <ul id="admin-user-list" class="user-list">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞–¥–º–∏–Ω–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </ul>
                </div>
            </div>
            
            <div class="tab-content" id="messages-tab">
                <div class="container">
                    <h3>–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h3>
                    <div id="admin-messages" class="chat-container">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                    <div class="form-group">
                        <button id="clear-all-messages" class="btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π</button>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="admin-chat-tab">
                <div class="container">
                    <h3>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                    <div class="form-group">
                        <select id="admin-message-type">
                            <option value="info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</option>
                            <option value="warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</option>
                            <option value="announcement">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <textarea id="admin-message-input" placeholder="–¢–µ–∫—Å—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <button id="send-admin-message" class="btn-warning">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="advertisements-tab">
                <div class="container">
                    <h3>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                    <div id="advertisement-alerts">
                        <!-- –û–ø–æ–≤–µ—â–µ–Ω–∏—è –æ —Ä–µ–∫–ª–∞–º–µ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="reports-tab">
                <div class="container">
                    <h3>–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                    <div id="reports-list">
                        <!-- –°–ø–∏—Å–æ–∫ –∂–∞–ª–æ–± –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="private-messages-tab">
                <div class="container">
                    <h3>–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                    <div class="form-group">
                        <select id="private-conversation-selector">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</option>
                        </select>
                    </div>
                    <div id="admin-private-messages" class="chat-container">
                        <!-- –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ -->
        <div id="logout-modal" class="modal">
            <div class="modal-content">
                <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞</h3>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?</p>
                <div class="modal-buttons">
                    <button id="confirm-logout" class="btn-danger">–í—ã–π—Ç–∏</button>
                    <button id="cancel-logout">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ -->
        <div id="ban-modal" class="modal">
            <div class="modal-content">
                <h3>–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                <div class="form-group">
                    <input type="text" id="ban-reason" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏" required>
                </div>
                <div class="ban-time-controls">
                    <input type="number" id="ban-duration" placeholder="–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å" min="1" value="1" required>
                    <select id="ban-time-unit">
                        <option value="seconds">–°–µ–∫—É–Ω–¥—ã</option>
                        <option value="minutes">–ú–∏–Ω—É—Ç—ã</option>
                        <option value="hours">–ß–∞—Å—ã</option>
                        <option value="days">–î–Ω–∏</option>
                    </select>
                </div>
                <div class="modal-buttons">
                    <button id="confirm-ban" class="btn-danger">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button id="cancel-ban">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        class UserManager {
            constructor() {
                this.users = JSON.parse(localStorage.getItem('chatUsers')) || [];
                this.currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
                this.adminPassword = 'admin228';
                this.bannedUsers = JSON.parse(localStorage.getItem('bannedUsers')) || {};
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (this.users.length === 0) {
                    this.initializeDemoUsers();
                }
                // –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
                this.startBanChecker();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            initializeDemoUsers() {
                const demoUsers = [
                    {
                        id: '1',
                        username: 'user1',
                        email: 'user1@example.com',
                        password: 'password1',
                        isOnline: false,
                        isAdmin: false,
                        isBanned: false,
                        isPremium: false,
                        banReason: '',
                        registrationDate: new Date().toISOString(),
                        lastLogin: new Date().toISOString()
                    },
                    {
                        id: '2', 
                        username: 'user2',
                        email: 'user2@example.com',
                        password: 'password2',
                        isOnline: false,
                        isAdmin: false,
                        isBanned: false,
                        isPremium: true,
                        banReason: '',
                        registrationDate: new Date().toISOString(),
                        lastLogin: new Date().toISOString()
                    }
                ];
                
                this.users = demoUsers;
                this.saveUsers();
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ localStorage
            saveUsers() {
                localStorage.setItem('chatUsers', JSON.stringify(this.users));
                localStorage.setItem('bannedUsers', JSON.stringify(this.bannedUsers));
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
            startBanChecker() {
                setInterval(() => {
                    this.checkBans();
                }, 1000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
            checkBans() {
                const now = Date.now();
                let updated = false;
                
                for (const userId in this.bannedUsers) {
                    if (this.bannedUsers[userId].unbanTime <= now) {
                        // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        const user = this.users.find(u => u.id === userId);
                        if (user) {
                            user.isBanned = false;
                            user.banReason = '';
                        }
                        delete this.bannedUsers[userId];
                        updated = true;
                    }
                }
                
                if (updated) {
                    this.saveUsers();
                    
                    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    if (this.currentUser && this.currentUser.id in this.bannedUsers === false) {
                        const user = this.users.find(u => u.id === this.currentUser.id);
                        if (user && !user.isBanned) {
                            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
                            if (window.chatApp) {
                                window.chatApp.showChat();
                            }
                        }
                    }
                }
            }
            
            // –ü–æ–ª—É—á–∏—Ç—å –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            getBanTimeRemaining(userId) {
                if (this.bannedUsers[userId]) {
                    const remaining = this.bannedUsers[userId].unbanTime - Date.now();
                    if (remaining > 0) {
                        return remaining;
                    }
                }
                return 0;
            }
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
            formatTimeRemaining(ms) {
                const seconds = Math.floor(ms / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24);
                
                if (days > 0) return `${days}–¥ ${hours % 24}—á ${minutes % 60}–º`;
                if (hours > 0) return `${hours}—á ${minutes % 60}–º ${seconds % 60}—Å`;
                if (minutes > 0) return `${minutes}–º ${seconds % 60}—Å`;
                return `${seconds}—Å`;
            }
            
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            register(username, email, password) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (this.users.find(user => user.username === username)) {
                    return { success: false, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' };
                }
                
                if (this.users.find(user => user.email === email)) {
                    return { success: false, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' };
                }
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const newUser = {
                    id: Date.now().toString(),
                    username,
                    email,
                    password,
                    isOnline: true,
                    isAdmin: false,
                    isBanned: false,
                    isPremium: false,
                    banReason: '',
                    registrationDate: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                };
                
                this.users.push(newUser);
                this.saveUsers();
                
                return { success: true, user: newUser };
            }
            
            // –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            login(username, password) {
                const user = this.users.find(u => u.username === username && u.password === password);
                
                if (!user) {
                    return { success: false, message: '–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å' };
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                const banTimeRemaining = this.getBanTimeRemaining(user.id);
                if (banTimeRemaining > 0) {
                    return { 
                        success: false, 
                        message: `–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ü—Ä–∏—á–∏–Ω–∞: ${user.banReason}. –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑: ${this.formatTimeRemaining(banTimeRemaining)}` 
                    };
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                if (user.isBanned && !this.bannedUsers[user.id]) {
                    return { success: false, message: `–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ü—Ä–∏—á–∏–Ω–∞: ${user.banReason}` };
                }
                
                user.isOnline = true;
                user.lastLogin = new Date().toISOString();
                this.saveUsers();
                this.currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                return { success: true, user };
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
            recoverPassword(email) {
                const user = this.users.find(u => u.email === email);
                
                if (!user) {
                    return { success: false, message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω' };
                }
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –æ—Ç–ø—Ä–∞–≤–∫–∞ email
                return { success: true, message: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ –≤–∞—à email' };
            }
            
            // –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            adminLogin(password) {
                if (password !== this.adminPassword) {
                    return { success: false, message: '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞' };
                }
                
                const adminUser = {
                    id: 'admin',
                    username: '–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                    isOnline: true,
                    isAdmin: true,
                    isPremium: true
                };
                
                this.currentUser = adminUser;
                localStorage.setItem('currentUser', JSON.stringify(adminUser));
                
                return { success: true, user: adminUser };
            }
            
            // –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            logout() {
                if (this.currentUser && this.currentUser.id !== 'admin') {
                    const user = this.users.find(u => u.id === this.currentUser.id);
                    if (user) {
                        user.isOnline = false;
                        this.saveUsers();
                    }
                }
                
                this.currentUser = null;
                localStorage.removeItem('currentUser');
            }
            
            // –ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤—Ä–µ–º–µ–Ω–µ–º
            banUser(userId, reason, duration = 0, timeUnit = 'minutes') {
                const user = this.users.find(u => u.id === userId);
                if (!user) return false;
                
                let banDuration = 0;
                switch (timeUnit) {
                    case 'seconds':
                        banDuration = duration * 1000;
                        break;
                    case 'minutes':
                        banDuration = duration * 60 * 1000;
                        break;
                    case 'hours':
                        banDuration = duration * 60 * 60 * 1000;
                        break;
                    case 'days':
                        banDuration = duration * 24 * 60 * 60 * 1000;
                        break;
                }
                
                user.isBanned = true;
                user.banReason = reason;
                user.isOnline = false;
                
                if (banDuration > 0) {
                    this.bannedUsers[userId] = {
                        reason: reason,
                        unbanTime: Date.now() + banDuration
                    };
                }
                
                this.saveUsers();
                
                // –ï—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –≤—ã–∫–∏–Ω—É—Ç—å –µ–≥–æ
                if (this.currentUser && this.currentUser.id === userId) {
                    this.currentUser = null;
                    localStorage.removeItem('currentUser');
                    if (window.chatApp) {
                        window.chatApp.showScreen('welcome-screen');
                        alert(`–í—ã –±—ã–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã. –ü—Ä–∏—á–∏–Ω–∞: ${reason}${banDuration > 0 ? `. –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑: ${this.formatTimeRemaining(banDuration)}` : ''}`);
                    }
                }
                
                return true;
            }
            
            // –†–∞–∑–±–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            unbanUser(userId) {
                const user = this.users.find(u => u.id === userId);
                if (user) {
                    user.isBanned = false;
                    user.banReason = '';
                    delete this.bannedUsers[userId];
                    this.saveUsers();
                    return true;
                }
                return false;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            getOnlineUsers() {
                return this.users.filter(user => user.isOnline && !user.isBanned && !this.getBanTimeRemaining(user.id));
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            getAllUsers() {
                return this.users;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            getBannedUsers() {
                return this.users.filter(user => user.isBanned || this.getBanTimeRemaining(user.id));
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–º–∏—É–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            getPremiumUsers() {
                return this.users.filter(user => user.isPremium);
            }
            
            // –í—ã–¥–∞—á–∞/—Å–Ω—è—Ç–∏–µ –ø—Ä–µ–º–∏—É–º —Å—Ç–∞—Ç—É—Å–∞
            togglePremium(userId) {
                const user = this.users.find(u => u.id === userId);
                if (user) {
                    user.isPremium = !user.isPremium;
                    this.saveUsers();
                    return user.isPremium;
                }
                return false;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            deleteUser(userId) {
                this.users = this.users.filter(user => user.id !== userId);
                delete this.bannedUsers[userId];
                this.saveUsers();
            }
        }

        // –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
        class MessageManager {
            constructor() {
                this.messages = JSON.parse(localStorage.getItem('chatMessages')) || [];
                this.privateMessages = JSON.parse(localStorage.getItem('privateMessages')) || [];
                this.reports = JSON.parse(localStorage.getItem('chatReports')) || [];
                this.advertisementKeywords = [
                    '–∫—É–ø–∏—Ç—å', '–ø—Ä–æ–¥–∞—Ç—å', '—Å–∫–∏–¥–∫–∞', '–∞–∫—Ü–∏—è', '–±–µ—Å–ø–ª–∞—Ç–Ω–æ', '—Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è',
                    '—Ä–µ–∫–ª–∞–º–∞', '–∑–∞–∫–∞–∑–∞—Ç—å', '—Ü–µ–Ω–∞', '–º–∞–≥–∞–∑–∏–Ω', '–∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω', '–¥–æ—Å—Ç–∞–≤–∫–∞',
                    '–æ–ø—Ç–æ–º', '—Ä–æ–∑–Ω–∏—Ü–∞', '—Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞', '—Å–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ', '–ø—Ä–æ–º–æ–∫–æ–¥'
                ];
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-—Å–æ–æ–±—â–µ–Ω–∏–π –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (this.messages.length === 0) {
                    this.initializeDemoMessages();
                }
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–º–æ-—Å–æ–æ–±—â–µ–Ω–∏–π
            initializeDemoMessages() {
                const demoMessages = [
                    {
                        id: '1',
                        userId: '1',
                        username: 'user1',
                        content: '–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.',
                        isAdminMessage: false,
                        messageType: 'user',
                        isAdvertisement: false,
                        isSticker: false,
                        timestamp: new Date(Date.now() - 3600000).toISOString()
                    },
                    {
                        id: '2',
                        userId: '2',
                        username: 'user2',
                        content: '–ü—Ä–∏–≤–µ—Ç! –£ –º–µ–Ω—è –ø—Ä–µ–º–∏—É–º –∞–∫–∫–∞—É–Ω—Ç! üëë',
                        isAdminMessage: false,
                        messageType: 'user',
                        isAdvertisement: false,
                        isSticker: false,
                        timestamp: new Date(Date.now() - 1800000).toISOString()
                    }
                ];
                
                this.messages = demoMessages;
                this.saveData();
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
            saveData() {
                localStorage.setItem('chatMessages', JSON.stringify(this.messages));
                localStorage.setItem('privateMessages', JSON.stringify(this.privateMessages));
                localStorage.setItem('chatReports', JSON.stringify(this.reports));
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            addMessage(userId, username, content, isAdminMessage = false, messageType = 'user', imageData = null, isPremium = false) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∫–ª–∞–º—É
                const isAdvertisement = this.checkForAdvertisement(content);
                
                const newMessage = {
                    id: Date.now().toString(),
                    userId,
                    username,
                    content,
                    isAdminMessage,
                    messageType,
                    isAdvertisement,
                    isSticker: this.isSticker(content),
                    imageData: imageData,
                    isPremium: isPremium,
                    timestamp: new Date().toISOString()
                };
                
                this.messages.push(newMessage);
                this.saveData();
                
                return newMessage;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∏–∫–µ—Ä
            isSticker(content) {
                const emojiRegex = /^(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff]){1,3}$/;
                return emojiRegex.test(content.trim());
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–∫–ª–∞–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            checkForAdvertisement(content) {
                if (!content) return false;
                const lowerContent = content.toLowerCase();
                return this.advertisementKeywords.some(keyword => 
                    lowerContent.includes(keyword.toLowerCase())
                );
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            getAllMessages() {
                return this.messages;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            getAdvertisementMessages() {
                return this.messages.filter(message => message.isAdvertisement);
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            getAdminMessages() {
                return this.messages.filter(message => message.isAdminMessage);
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            addPrivateMessage(senderId, senderName, recipientId, recipientName, content, imageData = null, isPremium = false) {
                const newMessage = {
                    id: Date.now().toString(),
                    senderId,
                    senderName,
                    recipientId,
                    recipientName,
                    content,
                    isSticker: this.isSticker(content),
                    imageData: imageData,
                    isPremium: isPremium,
                    timestamp: new Date().toISOString()
                };
                
                this.privateMessages.push(newMessage);
                this.saveData();
                
                return newMessage;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
            getPrivateMessages(user1Id, user2Id) {
                return this.privateMessages.filter(message => 
                    (message.senderId === user1Id && message.recipientId === user2Id) ||
                    (message.senderId === user2Id && message.recipientId === user1Id)
                );
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è –∞–¥–º–∏–Ω–∞)
            getAllPrivateMessages() {
                return this.privateMessages;
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∂–∞–ª–æ–±—ã
            addReport(reporterId, reporterName, messageId, reason) {
                const newReport = {
                    id: Date.now().toString(),
                    reporterId,
                    reporterName,
                    messageId,
                    reason,
                    timestamp: new Date().toISOString(),
                    resolved: false
                };
                
                this.reports.push(newReport);
                this.saveData();
                
                return newReport;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∂–∞–ª–æ–±
            getAllReports() {
                return this.reports;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            deleteMessage(messageId) {
                this.messages = this.messages.filter(message => message.id !== messageId);
                this.saveData();
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            deletePrivateMessage(messageId) {
                this.privateMessages = this.privateMessages.filter(message => message.id !== messageId);
                this.saveData();
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            editMessage(messageId, newContent) {
                const message = this.messages.find(m => m.id === messageId);
                if (message) {
                    message.content = newContent;
                    message.edited = true;
                    message.editTimestamp = new Date().toISOString();
                    this.saveData();
                    return true;
                }
                return false;
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            editPrivateMessage(messageId, newContent) {
                const message = this.privateMessages.find(m => m.id === messageId);
                if (message) {
                    message.content = newContent;
                    message.edited = true;
                    message.editTimestamp = new Date().toISOString();
                    this.saveData();
                    return true;
                }
                return false;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            clearAllMessages() {
                this.messages = [];
                this.saveData();
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            clearAdvertisementMessages() {
                this.messages = this.messages.filter(message => !message.isAdvertisement);
                this.saveData();
            }
            
            // –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∂–∞–ª–æ–±—ã
            resolveReport(reportId) {
                const report = this.reports.find(r => r.id === reportId);
                if (report) {
                    report.resolved = true;
                    this.saveData();
                    return true;
                }
                return false;
            }
        }

        // –ö–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        class ChatApp {
            constructor() {
                this.userManager = new UserManager();
                this.messageManager = new MessageManager();
                this.currentChatType = 'public';
                this.currentPrivateRecipient = null;
                this.banModalUserId = null;
                this.init();
                window.chatApp = this;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            init() {
                this.bindEvents();
                this.checkAuthStatus();
                this.setupTabs();
                this.setupChatTypes();
                this.startAutoRefresh();
            }
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
            startAutoRefresh() {
                setInterval(() => {
                    if (this.userManager.currentUser) {
                        if (this.currentChatType === 'public') {
                            this.loadMessages();
                        } else if (this.currentChatType === 'private' && this.currentPrivateRecipient) {
                            this.loadPrivateMessages();
                        }
                        this.loadOnlineUsers();
                    }
                }, 1000); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            }
            
            // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
            bindEvents() {
                // –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
                document.getElementById('login-btn').addEventListener('click', () => this.showScreen('login-form'));
                document.getElementById('register-btn').addEventListener('click', () => this.showScreen('register-form'));
                document.getElementById('admin-btn').addEventListener('click', () => this.showScreen('admin-login-form'));
                
                // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
                document.getElementById('login-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('login-submit').addEventListener('click', () => this.handleLogin());
                document.getElementById('forgot-password-btn').addEventListener('click', () => this.showScreen('forgot-password-form'));
                
                // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
                document.getElementById('recovery-back').addEventListener('click', () => this.showScreen('login-form'));
                document.getElementById('recover-password').addEventListener('click', () => this.handlePasswordRecovery());
                
                // –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
                document.getElementById('register-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('register-submit').addEventListener('click', () => this.handleRegister());
                
                // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                document.getElementById('admin-login-back').addEventListener('click', () => this.showScreen('welcome-screen'));
                document.getElementById('admin-login-submit').addEventListener('click', () => this.handleAdminLogin());
                
                // –ß–∞—Ç
                document.getElementById('logout-btn').addEventListener('click', () => this.showLogoutModal());
                document.getElementById('send-message').addEventListener('click', () => this.sendMessage());
                document.getElementById('message-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                document.getElementById('upload-image-btn').addEventListener('click', () => this.uploadImage('public'));
                document.getElementById('upload-private-image-btn').addEventListener('click', () => this.uploadImage('private'));
                
                // –õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                document.getElementById('send-private-message').addEventListener('click', () => this.sendPrivateMessage());
                document.getElementById('private-recipient').addEventListener('change', (e) => {
                    this.currentPrivateRecipient = e.target.value;
                    this.loadPrivateMessages();
                });
                
                // –°—Ç–∏–∫–µ—Ä—ã
                document.querySelectorAll('.sticker').forEach(sticker => {
                    sticker.addEventListener('click', (e) => {
                        const stickerValue = e.target.getAttribute('data-sticker');
                        this.sendSticker(stickerValue);
                    });
                });
                
                // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                document.getElementById('admin-logout').addEventListener('click', () => this.showLogoutModal());
                document.getElementById('clear-all-messages').addEventListener('click', () => this.clearAllMessages());
                document.getElementById('send-admin-message').addEventListener('click', () => this.sendAdminMessage());
                document.getElementById('private-conversation-selector').addEventListener('change', (e) => {
                    this.loadAdminPrivateMessages(e.target.value);
                });
                
                // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
                document.getElementById('confirm-logout').addEventListener('click', () => this.handleLogout());
                document.getElementById('cancel-logout').addEventListener('click', () => this.hideLogoutModal());
                document.getElementById('confirm-ban').addEventListener('click', () => this.confirmBan());
                document.getElementById('cancel-ban').addEventListener('click', () => this.hideBanModal());
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∫–ª–∞–¥–æ–∫
            setupTabs() {
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        
                        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É
                        tab.classList.add('active');
                        document.getElementById(`${tabId}-tab`).classList.add('active');
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
                        if (tabId === 'users') {
                            this.loadAdminUserList();
                        } else if (tabId === 'messages') {
                            this.loadAdminMessages();
                        } else if (tabId === 'advertisements') {
                            this.loadAdvertisementAlerts();
                        } else if (tabId === 'private-messages') {
                            this.loadPrivateConversationsForAdmin();
                        } else if (tabId === 'reports') {
                            this.loadReports();
                        }
                    });
                });
            }
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∏–ø–æ–≤ —á–∞—Ç–∞
            setupChatTypes() {
                document.querySelectorAll('.chat-type').forEach(type => {
                    type.addEventListener('click', () => {
                        const chatType = type.getAttribute('data-chat-type');
                        
                        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤
                        document.querySelectorAll('.chat-type').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.chat-tab').forEach(t => t.classList.add('hidden'));
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç–∏–ø—É
                        type.classList.add('active');
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç
                        if (chatType === 'public') {
                            document.getElementById('public-chat').classList.remove('hidden');
                            this.currentChatType = 'public';
                            this.loadMessages();
                        } else {
                            document.getElementById('private-chat').classList.remove('hidden');
                            this.currentChatType = 'private';
                            this.loadPrivateRecipients();
                        }
                    });
                });
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            checkAuthStatus() {
                if (this.userManager.currentUser) {
                    if (this.userManager.currentUser.isAdmin) {
                        this.showAdminPanel();
                    } else {
                        this.showChat();
                    }
                } else {
                    this.showScreen('welcome-screen');
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
            showScreen(screenId) {
                document.querySelectorAll('#app > div').forEach(div => {
                    div.classList.add('hidden');
                });
                document.getElementById(screenId).classList.remove('hidden');
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã—Ö–æ–¥–∞
            showLogoutModal() {
                document.getElementById('logout-modal').style.display = 'flex';
            }
            
            // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã—Ö–æ–¥–∞
            hideLogoutModal() {
                document.getElementById('logout-modal').style.display = 'none';
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            showBanModal(userId) {
                this.banModalUserId = userId;
                document.getElementById('ban-modal').style.display = 'flex';
                document.getElementById('ban-reason').value = '';
                document.getElementById('ban-duration').value = '1';
                document.getElementById('ban-time-unit').value = 'minutes';
            }
            
            // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            hideBanModal() {
                document.getElementById('ban-modal').style.display = 'none';
                this.banModalUserId = null;
            }
            
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            confirmBan() {
                const reason = document.getElementById('ban-reason').value;
                const duration = parseInt(document.getElementById('ban-duration').value);
                const timeUnit = document.getElementById('ban-time-unit').value;
                
                if (!reason) {
                    alert('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏');
                    return;
                }
                
                if (this.userManager.banUser(this.banModalUserId, reason, duration, timeUnit)) {
                    alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω');
                    this.loadAdminUserList();
                    this.hideBanModal();
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
            handleLogin() {
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                const errorElement = document.getElementById('login-error');
                
                if (!username || !password) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                const result = this.userManager.login(username, password);
                
                if (result.success) {
                    this.showChat();
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
            handlePasswordRecovery() {
                const email = document.getElementById('recovery-email').value;
                const errorElement = document.getElementById('recovery-error');
                const successElement = document.getElementById('recovery-success');
                
                if (!email) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ email';
                    errorElement.classList.remove('hidden');
                    successElement.classList.add('hidden');
                    return;
                }
                
                const result = this.userManager.recoverPassword(email);
                
                if (result.success) {
                    successElement.textContent = result.message;
                    successElement.classList.remove('hidden');
                    errorElement.classList.add('hidden');
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                    successElement.classList.add('hidden');
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            handleRegister() {
                const username = document.getElementById('register-username').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm-password').value;
                const errorElement = document.getElementById('register-error');
                const successElement = document.getElementById('register-success');
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                errorElement.classList.add('hidden');
                successElement.classList.add('hidden');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π
                if (!username || !email || !password || !confirmPassword) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
                if (password !== confirmPassword) {
                    errorElement.textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const result = this.userManager.register(username, email, password);
                
                if (result.success) {
                    successElement.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏.';
                    successElement.classList.remove('hidden');
                    
                    // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
                    document.getElementById('register-username').value = '';
                    document.getElementById('register-email').value = '';
                    document.getElementById('register-password').value = '';
                    document.getElementById('register-confirm-password').value = '';
                    
                    // –í–æ–∑–≤—Ä–∞—Ç –∫ —ç–∫—Ä–∞–Ω—É –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        this.showScreen('login-form');
                    }, 2000);
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            handleAdminLogin() {
                const password = document.getElementById('admin-password').value;
                const errorElement = document.getElementById('admin-login-error');
                
                if (!password) {
                    errorElement.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å';
                    errorElement.classList.remove('hidden');
                    return;
                }
                
                const result = this.userManager.adminLogin(password);
                
                if (result.success) {
                    this.showAdminPanel();
                } else {
                    errorElement.textContent = result.message;
                    errorElement.classList.remove('hidden');
                }
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–∞—Ç–∞
            showChat() {
                this.showScreen('chat-interface');
                document.getElementById('current-user').textContent = this.userManager.currentUser.username;
                this.loadMessages();
                this.loadOnlineUsers();
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            showAdminPanel() {
                this.showScreen('admin-panel');
                this.updateStats();
                this.loadAdminUserList();
                this.loadAdminMessages();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStats() {
                document.getElementById('total-users').textContent = this.userManager.getAllUsers().length;
                document.getElementById('online-users-count').textContent = this.userManager.getOnlineUsers().length;
                document.getElementById('total-messages').textContent = this.messageManager.getAllMessages().length;
                document.getElementById('banned-users').textContent = this.userManager.getBannedUsers().length;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç
            loadMessages() {
                const messagesContainer = document.getElementById('chat-messages');
                const messages = this.messageManager.getAllMessages();
                
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = this.createMessageElement(message, false);
                    messagesContainer.appendChild(messageElement);
                });
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            createMessageElement(message, isPrivate = false) {
                const messageElement = document.createElement('div');
                messageElement.className = 'message';
                messageElement.dataset.messageId = message.id;
                
                if ((!isPrivate && message.userId === this.userManager.currentUser?.id) || 
                    (isPrivate && message.senderId === this.userManager.currentUser?.id)) {
                    messageElement.classList.add('my-message');
                } else if (message.isAdminMessage) {
                    messageElement.classList.add('admin-message');
                } else if (message.isAdvertisement) {
                    messageElement.classList.add('advertisement-message');
                } else if (isPrivate) {
                    messageElement.classList.add('private-message');
                }
                
                let headerText = isPrivate ? message.senderName : message.username;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–º–∏—É–º –±–µ–π–¥–∂ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–º–∏—É–º
                const user = this.userManager.users.find(u => 
                    isPrivate ? u.id === message.senderId : u.id === message.userId
                );
                
                if (user && user.isPremium) {
                    headerText = `<span class="premium-user">${headerText}</span> <span class="premium-badge">PREMIUM üëë</span>`;
                }
                
                if (message.isAdminMessage) headerText += ' (–°–∏—Å—Ç–µ–º–∞)';
                if (isPrivate && message.senderId !== this.userManager.currentUser?.id) {
                    headerText += ' ‚Üí –≤–∞–º';
                } else if (isPrivate) {
                    headerText += ' ‚Üí ' + message.recipientName;
                }
                
                let content = '';
                if (message.imageData) {
                    content = `<img src="${message.imageData}" class="image-message" alt="–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
                } else if (message.isSticker) {
                    content = `<div class="sticker-message">${message.content}</div>`;
                } else {
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–µ–º–∏—É–º —Å—Ç–∏–ª—å –∫ —Ç–µ–∫—Å—Ç—É —Å–æ–æ–±—â–µ–Ω–∏—è –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–º–∏—É–º
                    if (user && user.isPremium) {
                        content = `<div class="message-content premium-user">${this.escapeHtml(message.content)}</div>`;
                    } else {
                        content = `<div class="message-content">${this.escapeHtml(message.content)}</div>`;
                    }
                }
                
                if (message.edited) {
                    content += `<div class="edited-indicator">(–∏–∑–º–µ–Ω–µ–Ω–æ)</div>`;
                }
                
                messageElement.innerHTML = `
                    <div class="message-header">
                        <span>${headerText}</span>
                        <span>${new Date(message.timestamp).toLocaleString()}</span>
                    </div>
                    ${content}
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∂–∞–ª–æ–±—ã –¥–ª—è —á—É–∂–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
                if ((!isPrivate && message.userId !== this.userManager.currentUser?.id && !message.isAdminMessage) || 
                    (isPrivate && message.senderId !== this.userManager.currentUser?.id)) {
                    const reportButton = document.createElement('button');
                    reportButton.className = 'report-button';
                    reportButton.textContent = '–ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è';
                    reportButton.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.reportMessage(message.id, isPrivate);
                    });
                    
                    const header = messageElement.querySelector('.message-header');
                    header.appendChild(reportButton);
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å–≤–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
                if ((!isPrivate && message.userId === this.userManager.currentUser?.id) || 
                    (isPrivate && message.senderId === this.userManager.currentUser?.id)) {
                    const messageControls = document.createElement('div');
                    messageControls.className = 'message-controls';
                    messageControls.innerHTML = `
                        <button class="edit-message" data-message-id="${message.id}">‚úèÔ∏è</button>
                        <button class="delete-message" data-message-id="${message.id}">üóëÔ∏è</button>
                    `;
                    messageElement.appendChild(messageControls);
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
                    messageControls.querySelector('.edit-message').addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.editMessage(message.id, isPrivate);
                    });
                    
                    messageControls.querySelector('.delete-message').addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.deleteMessage(message.id, isPrivate);
                    });
                }
                
                return messageElement;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            loadOnlineUsers() {
                const usersContainer = document.getElementById('online-users');
                const allUsers = this.userManager.getAllUsers();
                
                usersContainer.innerHTML = '';
                
                allUsers.forEach(user => {
                    if (user.id === this.userManager.currentUser?.id) return;
                    
                    const userElement = document.createElement('li');
                    const indicator = user.isOnline ? 'online-indicator' : 'offline-indicator';
                    const status = user.isOnline ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ—Ñ–ª–∞–π–Ω';
                    const premiumBadge = user.isPremium ? ' <span class="premium-badge">PREMIUM üëë</span>' : '';
                    
                    userElement.innerHTML = `
                        <span><span class="${indicator}"></span>${user.username} (${status})${premiumBadge}</span>
                        ${user.isAdmin ? '<span class="admin-badge">–ê–¥–º–∏–Ω</span>' : ''}
                        ${user.isBanned ? '<span class="banned-badge">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>' : ''}
                    `;
                    usersContainer.appendChild(userElement);
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            loadPrivateRecipients() {
                const recipientSelect = document.getElementById('private-recipient');
                const allUsers = this.userManager.getAllUsers();
                
                recipientSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</option>';
                
                allUsers.forEach(user => {
                    if (user.id === this.userManager.currentUser?.id || user.isBanned) return;
                    
                    const option = document.createElement('option');
                    option.value = user.id;
                    const premiumBadge = user.isPremium ? ' (PREMIUM üëë)' : '';
                    option.textContent = user.username + premiumBadge + (user.isOnline ? ' (–û–Ω–ª–∞–π–Ω)' : ' (–û—Ñ—Ñ–ª–∞–π–Ω)');
                    recipientSelect.appendChild(option);
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            loadPrivateMessages() {
                if (!this.currentPrivateRecipient) return;
                
                const messagesContainer = document.getElementById('private-messages');
                const messages = this.messageManager.getPrivateMessages(
                    this.userManager.currentUser.id, 
                    this.currentPrivateRecipient
                );
                
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = this.createMessageElement(message, true);
                    messagesContainer.appendChild(messageElement);
                });
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            uploadImage(chatType) {
                const fileInput = chatType === 'public' ? 
                    document.getElementById('image-upload') : 
                    document.getElementById('private-image-upload');
                
                const file = fileInput.files[0];
                if (!file) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
                    return;
                }
                
                if (!file.type.startsWith('image/')) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = e.target.result;
                    const user = this.userManager.currentUser;
                    
                    if (chatType === 'public') {
                        this.messageManager.addMessage(
                            user.id,
                            user.username,
                            '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
                            false,
                            'user',
                            imageData,
                            user.isPremium
                        );
                        this.loadMessages();
                    } else {
                        if (!this.currentPrivateRecipient) {
                            alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è');
                            return;
                        }
                        
                        const recipient = this.userManager.users.find(u => u.id === this.currentPrivateRecipient);
                        this.messageManager.addPrivateMessage(
                            user.id,
                            user.username,
                            this.currentPrivateRecipient,
                            recipient.username,
                            '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
                            imageData,
                            user.isPremium
                        );
                        this.loadPrivateMessages();
                    }
                    
                    fileInput.value = '';
                };
                reader.readAsDataURL(file);
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            sendMessage() {
                const messageInput = document.getElementById('message-input');
                const content = messageInput.value.trim();
                
                if (!content) return;
                
                const user = this.userManager.currentUser;
                this.messageManager.addMessage(
                    user.id,
                    user.username,
                    content,
                    false,
                    'user',
                    null,
                    user.isPremium
                );
                
                messageInput.value = '';
                this.loadMessages();
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∏–∫–µ—Ä–∞
            sendSticker(sticker) {
                const user = this.userManager.currentUser;
                this.messageManager.addMessage(
                    user.id,
                    user.username,
                    sticker,
                    false,
                    'user',
                    null,
                    user.isPremium
                );
                
                this.loadMessages();
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            sendPrivateMessage() {
                if (!this.currentPrivateRecipient) {
                    alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è');
                    return;
                }
                
                const messageInput = document.getElementById('private-message-input');
                const content = messageInput.value.trim();
                
                if (!content) return;
                
                const user = this.userManager.currentUser;
                const recipient = this.userManager.users.find(u => u.id === this.currentPrivateRecipient);
                
                this.messageManager.addPrivateMessage(
                    user.id,
                    user.username,
                    this.currentPrivateRecipient,
                    recipient.username,
                    content,
                    null,
                    user.isPremium
                );
                
                messageInput.value = '';
                this.loadPrivateMessages();
            }
            
            // –ñ–∞–ª–æ–±–∞ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
            reportMessage(messageId, isPrivate = false) {
                const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –∂–∞–ª–æ–±—ã:');
                if (reason && reason.trim()) {
                    this.messageManager.addReport(
                        this.userManager.currentUser.id,
                        this.userManager.currentUser.username,
                        messageId,
                        reason.trim()
                    );
                    alert('–ñ–∞–ª–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É');
                }
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            editMessage(messageId, isPrivate = false) {
                let message;
                if (isPrivate) {
                    message = this.messageManager.privateMessages.find(m => m.id === messageId);
                } else {
                    message = this.messageManager.messages.find(m => m.id === messageId);
                }
                
                if (!message) return;
                
                // –ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                if (message.imageData) {
                    alert('–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏');
                    return;
                }
                
                const newContent = prompt('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:', message.content);
                if (newContent !== null && newContent.trim() !== '') {
                    if (isPrivate) {
                        this.messageManager.editPrivateMessage(messageId, newContent.trim());
                    } else {
                        this.messageManager.editMessage(messageId, newContent.trim());
                    }
                    
                    if (this.currentChatType === 'public') {
                        this.loadMessages();
                    } else {
                        this.loadPrivateMessages();
                    }
                    
                    if (this.userManager.currentUser.isAdmin) {
                        this.loadAdminMessages();
                    }
                }
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            deleteMessage(messageId, isPrivate = false) {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {
                    if (isPrivate) {
                        this.messageManager.deletePrivateMessage(messageId);
                        if (this.currentChatType === 'private') {
                            this.loadPrivateMessages();
                        }
                    } else {
                        this.messageManager.deleteMessage(messageId);
                        if (this.currentChatType === 'public') {
                            this.loadMessages();
                        }
                    }
                    
                    if (this.userManager.currentUser.isAdmin) {
                        this.loadAdminMessages();
                    }
                }
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            loadAdminUserList() {
                const usersContainer = document.getElementById('admin-user-list');
                const allUsers = this.userManager.getAllUsers();
                
                usersContainer.innerHTML = '';
                
                allUsers.forEach(user => {
                    const userElement = document.createElement('li');
                    
                    const banButton = user.isBanned ? 
                        `<button class="btn-success unban-user" data-user-id="${user.id}">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>` :
                        `<button class="btn-warning ban-user" data-user-id="${user.id}">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>`;
                    
                    const premiumButton = user.isPremium ?
                        `<button class="btn-warning remove-premium" data-user-id="${user.id}">–°–Ω—è—Ç—å Premium</button>` :
                        `<button class="btn-premium give-premium" data-user-id="${user.id}">–í—ã–¥–∞—Ç—å Premium</button>`;
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                    let banInfo = '';
                    const banTimeRemaining = this.userManager.getBanTimeRemaining(user.id);
                    if (banTimeRemaining > 0) {
                        banInfo = `<div class="time-remaining">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑: ${this.userManager.formatTimeRemaining(banTimeRemaining)}</div>`;
                    }
                    
                    userElement.innerHTML = `
                        <div>
                            <strong>${user.username}</strong> (${user.email})
                            <div>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${new Date(user.registrationDate).toLocaleDateString()}</div>
                            <div>–ü–∞—Ä–æ–ª—å: <span class="password-display">${user.password}</span>
                                <button class="show-password-btn" data-password="${user.password}">üëÅÔ∏è</button>
                            </div>
                            ${user.isBanned ? `<div class="warning">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –ü—Ä–∏—á–∏–Ω–∞: ${user.banReason}</div>` : ''}
                            ${banInfo}
                            ${user.isPremium ? `<div class="success">PREMIUM –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å üëë</div>` : ''}
                        </div>
                        <div>
                            <span style="color: ${user.isOnline ? '#2ecc71' : '#e74c3c'}">
                                ${user.isOnline ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ—Ñ–ª–∞–π–Ω'}
                            </span>
                            <div class="admin-controls">
                                ${premiumButton}
                                ${banButton}
                                <button class="btn-danger delete-user" data-user-id="${user.id}">–£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        </div>
                    `;
                    usersContainer.appendChild(userElement);
                });
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.ban-user').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const userId = e.target.getAttribute('data-user-id');
                        this.showBanModal(userId);
                    });
                });
                
                document.querySelectorAll('.unban-user').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const userId = e.target.getAttribute('data-user-id');
                        this.unbanUser(userId);
                    });
                });
                
                document.querySelectorAll('.give-premium').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const userId = e.target.getAttribute('data-user-id');
                        this.togglePremium(userId);
                    });
                });
                
                document.querySelectorAll('.remove-premium').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const userId = e.target.getAttribute('data-user-id');
                        this.togglePremium(userId);
                    });
                });
                
                document.querySelectorAll('.delete-user').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const userId = e.target.getAttribute('data-user-id');
                        this.deleteUser(userId);
                    });
                });
                
                document.querySelectorAll('.show-password-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const password = e.target.getAttribute('data-password');
                        alert(`–ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${password}`);
                    });
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
            loadAdminMessages() {
                const messagesContainer = document.getElementById('admin-messages');
                const messages = this.messageManager.getAllMessages();
                
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.className = 'message';
                    
                    if (message.isAdminMessage) {
                        messageElement.classList.add('admin-message');
                    } else if (message.isAdvertisement) {
                        messageElement.classList.add('advertisement-message');
                    }
                    
                    let content = '';
                    if (message.imageData) {
                        content = `<img src="${message.imageData}" class="image-message" alt="–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
                    } else if (message.isSticker) {
                        content = `<div class="sticker-message">${message.content}</div>`;
                    } else {
                        content = `<div class="message-content">${this.escapeHtml(message.content)}</div>`;
                    }
                    
                    messageElement.innerHTML = `
                        <div class="message-header">
                            <span>${message.username} ${message.isAdminMessage ? '(–°–∏—Å—Ç–µ–º–∞)' : ''}</span>
                            <span>${new Date(message.timestamp).toLocaleString()}</span>
                            <button class="btn-danger delete-message" data-message-id="${message.id}">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                        ${content}
                    `;
                    
                    messagesContainer.appendChild(messageElement);
                });
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
                document.querySelectorAll('.delete-message').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const messageId = e.target.getAttribute('data-message-id');
                        this.deleteMessage(messageId);
                    });
                });
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –æ —Ä–µ–∫–ª–∞–º–µ
            loadAdvertisementAlerts() {
                const alertsContainer = document.getElementById('advertisement-alerts');
                const adMessages = this.messageManager.getAdvertisementMessages();
                
                alertsContainer.innerHTML = '';
                
                if (adMessages.length === 0) {
                    alertsContainer.innerHTML = '<p>–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞.</p>';
                    return;
                }
                
                adMessages.forEach(message => {
                    const alertElement = document.createElement('div');
                    alertElement.className = 'advertisement-alert';
                    
                    alertElement.innerHTML = `
                        <div class="message-header">
                            <span>${message.username}</span>
                            <span>${new Date(message.timestamp).toLocaleString()}</span>
                            <button class="btn-danger delete-message" data-message-id="${message.id}">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                        <div class="message-content">${this.escapeHtml(message.content)}</div>
                        <div class="admin-controls">
                            <button class="btn-warning ban-user" data-user-id="${message.userId}">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                            <button class="btn-danger clear-all-ads">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</button>
                        </div>
                    `;
                    
                    alertsContainer.appendChild(alertElement);
                });
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.delete-message').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const messageId = e.target.getAttribute('data-message-id');
                        this.deleteMessage(messageId);
                    });
                });
                
                document.querySelectorAll('.ban-user').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const userId = e.target.getAttribute('data-user-id');
                        this.showBanModal(userId);
                    });
                });
                
                document.querySelectorAll('.clear-all-ads').forEach(button => {
                    button.addEventListener('click', () => {
                        this.clearAdvertisementMessages();
                    });
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∂–∞–ª–æ–±
            loadReports() {
                const reportsContainer = document.getElementById('reports-list');
                const reports = this.messageManager.getAllReports();
                
                reportsContainer.innerHTML = '';
                
                if (reports.length === 0) {
                    reportsContainer.innerHTML = '<p>–ñ–∞–ª–æ–± –Ω–µ—Ç.</p>';
                    return;
                }
                
                reports.forEach(report => {
                    const reportElement = document.createElement('div');
                    reportElement.className = 'report-message';
                    reportElement.innerHTML = `
                        <div class="message-header">
                            <span>–ñ–∞–ª–æ–±–∞ –æ—Ç: ${report.reporterName}</span>
                            <span>${new Date(report.timestamp).toLocaleString()}</span>
                            ${report.resolved ? '<span style="color: #2ecc71">–†–ï–®–ï–ù–ê</span>' : '<span style="color: #e74c3c">–ù–ï –†–ï–®–ï–ù–ê</span>'}
                        </div>
                        <div class="message-content">
                            <strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> ${this.escapeHtml(report.reason)}
                        </div>
                        <div class="admin-controls">
                            <button class="btn-success resolve-report" data-report-id="${report.id}">–ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω—É—é</button>
                            <button class="btn-danger delete-report" data-report-id="${report.id}">–£–¥–∞–ª–∏—Ç—å –∂–∞–ª–æ–±—É</button>
                        </div>
                    `;
                    
                    reportsContainer.appendChild(reportElement);
                });
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫
                document.querySelectorAll('.resolve-report').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const reportId = e.target.getAttribute('data-report-id');
                        this.resolveReport(reportId);
                    });
                });
                
                document.querySelectorAll('.delete-report').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const reportId = e.target.getAttribute('data-report-id');
                        this.deleteReport(reportId);
                    });
                });
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω–∞
            loadPrivateConversationsForAdmin() {
                const selector = document.getElementById('private-conversation-selector');
                const allUsers = this.userManager.getAllUsers();
                
                selector.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</option>';
                
                // –°–æ–∑–¥–∞–µ–º –æ–ø—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                for (let i = 0; i < allUsers.length; i++) {
                    for (let j = i + 1; j < allUsers.length; j++) {
                        const user1 = allUsers[i];
                        const user2 = allUsers[j];
                        
                        const option = document.createElement('option');
                        option.value = `${user1.id}-${user2.id}`;
                        option.textContent = `${user1.username} ‚Üî ${user2.username}`;
                        selector.appendChild(option);
                    }
                }
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–¥–º–∏–Ω–∞
            loadAdminPrivateMessages(conversationId) {
                if (!conversationId) return;
                
                const [user1Id, user2Id] = conversationId.split('-');
                const messagesContainer = document.getElementById('admin-private-messages');
                const messages = this.messageManager.getPrivateMessages(user1Id, user2Id);
                
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.className = 'message private-message';
                    
                    let content = '';
                    if (message.imageData) {
                        content = `<img src="${message.imageData}" class="image-message" alt="–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
                    } else if (message.isSticker) {
                        content = `<div class="sticker-message">${message.content}</div>`;
                    } else {
                        content = `<div class="message-content">${this.escapeHtml(message.content)}</div>`;
                    }
                    
                    messageElement.innerHTML = `
                        <div class="message-header">
                            <span>${message.senderName} ‚Üí ${message.recipientName}</span>
                            <span>${new Date(message.timestamp).toLocaleString()}</span>
                            <button class="btn-danger delete-message" data-message-id="${message.id}" data-private="true">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                        ${content}
                    `;
                    
                    messagesContainer.appendChild(messageElement);
                });
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è
                document.querySelectorAll('.delete-message[data-private="true"]').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const messageId = e.target.getAttribute('data-message-id');
                        this.messageManager.deletePrivateMessage(messageId);
                        this.loadAdminPrivateMessages(conversationId);
                    });
                });
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            sendAdminMessage() {
                const messageInput = document.getElementById('admin-message-input');
                const messageType = document.getElementById('admin-message-type').value;
                const content = messageInput.value.trim();
                
                if (!content) return;
                
                let formattedContent = content;
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
                switch(messageType) {
                    case 'info':
                        formattedContent = `‚ÑπÔ∏è –°–ò–°–¢–ï–ú–ê: ${content}`;
                        break;
                    case 'warning':
                        formattedContent = `‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: ${content}`;
                        break;
                    case 'announcement':
                        formattedContent = `üì¢ –û–§–ò–¶–ò–ê–õ–¨–ù–û: ${content}`;
                        break;
                }
                
                this.messageManager.addMessage(
                    this.userManager.currentUser.id,
                    this.userManager.currentUser.username,
                    formattedContent,
                    true,
                    messageType
                );
                
                messageInput.value = '';
                this.loadAdminMessages();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ
                alert('–°–∏—Å—Ç–µ–º–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ');
            }
            
            // –†–∞–∑–±–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            unbanUser(userId) {
                if (this.userManager.unbanUser(userId)) {
                    alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω');
                    this.loadAdminUserList();
                }
            }
            
            // –í—ã–¥–∞—á–∞/—Å–Ω—è—Ç–∏–µ –ø—Ä–µ–º–∏—É–º —Å—Ç–∞—Ç—É—Å–∞
            togglePremium(userId) {
                const isPremium = this.userManager.togglePremium(userId);
                if (isPremium !== false) {
                    alert(isPremium ? 'Premium —Å—Ç–∞—Ç—É—Å –≤—ã–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é' : 'Premium —Å—Ç–∞—Ç—É—Å —Å–Ω—è—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    this.loadAdminUserList();
                }
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            deleteUser(userId) {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                    this.userManager.deleteUser(userId);
                    this.loadAdminUserList();
                    this.updateStats();
                }
            }
            
            // –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∂–∞–ª–æ–±—ã
            resolveReport(reportId) {
                if (this.messageManager.resolveReport(reportId)) {
                    alert('–ñ–∞–ª–æ–±–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω–∞—è');
                    this.loadReports();
                }
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –∂–∞–ª–æ–±—ã
            deleteReport(reportId) {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∂–∞–ª–æ–±—É?')) {
                    this.messageManager.reports = this.messageManager.reports.filter(r => r.id !== reportId);
                    this.messageManager.saveData();
                    this.loadReports();
                }
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            clearAllMessages() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è?')) {
                    this.messageManager.clearAllMessages();
                    this.loadAdminMessages();
                    this.loadAdvertisementAlerts();
                }
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
            clearAdvertisementMessages() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è?')) {
                    this.messageManager.clearAdvertisementMessages();
                    this.loadAdminMessages();
                    this.loadAdvertisementAlerts();
                }
            }
            
            // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
            handleLogout() {
                this.userManager.logout();
                this.hideLogoutModal();
                this.showScreen('welcome-screen');
            }
            
            // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        document.addEventListener('DOMContentLoaded', () => {
            new ChatApp();
        });
    </script>
</body>
</html>